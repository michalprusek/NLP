<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIPO: Latent Instruction Prompt Optimization</title>

    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Dark theme palette */
            --bg-deep: #0a0e14;
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #1c2128;
            --bg-card: #21262d;

            /* Text colors */
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;

            /* Accent colors - pipeline stages */
            --accent-cyan: #00d9ff;      /* Encoding */
            --accent-blue: #58a6ff;      /* Processing */
            --accent-purple: #a371f7;    /* Latent space */
            --accent-magenta: #f778ba;   /* Optimization */
            --accent-green: #3fb950;     /* Success/Output */
            --accent-orange: #d29922;    /* Warning/Attention */
            --accent-red: #f85149;       /* Error/Important */

            /* Gradients */
            --gradient-cyan: linear-gradient(135deg, #00d9ff 0%, #0099cc 100%);
            --gradient-purple: linear-gradient(135deg, #a371f7 0%, #8957e5 100%);
            --gradient-green: linear-gradient(135deg, #3fb950 0%, #238636 100%);
            --gradient-orange: linear-gradient(135deg, #d29922 0%, #bb8009 100%);

            /* Typography */
            --font-display: 'Outfit', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;

            /* Spacing - adaptive */
            --slide-padding: clamp(20px, 4vmin, 60px);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--bg-deep);
            font-family: var(--font-display);
            color: var(--text-primary);
        }

        /* Presentation container */
        .presentation {
            width: 100%;
            height: 100%;
            position: relative;
        }

        /* Individual slides */
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: var(--slide-padding);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            background: var(--bg-primary);
            overflow: hidden;
        }

        /* Adaptive content - fill page while preventing overflow */
        .slide > * {
            flex-shrink: 1;
            min-height: 0;
        }

        .slide .content-split,
        .slide .content-full,
        .slide .two-col {
            flex: 0 1 auto;
            min-height: 0;
            overflow: hidden;
            width: 100%;
        }

        .slide h1, .slide h2, .slide h3, .slide h4 {
            width: 100%;
            text-align: center;
        }

        .slide .content-split > *,
        .slide .two-col > * {
            min-height: 0;
            overflow: auto;
        }

        /* Diagram containers - centered */
        .slide .diagram-container {
            flex: 0 1 auto;
            min-height: 0;
            max-height: 70vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* SVG diagrams scale to fill */
        .slide .diagram-container svg {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
        }

        /* Tables - larger, fill width */
        .slide table {
            font-size: clamp(0.85rem, 2vmin, 1.1rem);
            width: 100%;
        }

        /* Lists - larger */
        .slide ul, .slide ol {
            font-size: clamp(1rem, 2.5vmin, 1.3rem);
        }

        /* Paragraphs - larger */
        .slide p {
            font-size: clamp(1rem, 2.5vmin, 1.35rem);
        }

        /* Cards and boxes - more padding */
        .slide .card,
        .slide .highlight-box {
            padding: clamp(0.75rem, 2vmin, 1.5rem);
            margin: clamp(0.5rem, 1.5vmin, 1rem) 0;
        }

        /* Math blocks - larger */
        .slide .math-block {
            padding: clamp(0.75rem, 2vmin, 1.5rem);
            font-size: clamp(1rem, 2.5vmin, 1.4rem);
        }

        /* Feature lists */
        .slide .feature-list {
            flex: 0 1 auto;
        }

        .slide.active {
            opacity: 1;
            visibility: visible;
        }

        /* Blueprint grid background */
        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                linear-gradient(rgba(0, 217, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 217, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 0;
        }

        .slide > * {
            position: relative;
            z-index: 1;
        }

        /* Typography */
        h1 {
            font-size: 3.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1.1;
            margin-bottom: 1rem;
            text-align: center;
            width: 100%;
        }

        h2 {
            font-size: clamp(2rem, 5vmin, 3rem);
            font-weight: 600;
            letter-spacing: -0.01em;
            margin-bottom: clamp(0.5rem, 2vmin, 1.5rem);
            color: var(--accent-cyan);
            flex-shrink: 0;
            text-align: center;
            width: 100%;
        }

        h3 {
            font-size: clamp(1rem, 2.5vmin, 1.5rem);
            font-weight: 500;
            margin-bottom: clamp(0.3rem, 1vmin, 1rem);
            color: var(--text-secondary);
        }

        p {
            font-size: 1.25rem;
            line-height: 1.6;
            color: var(--text-secondary);
            max-width: 900px;
        }

        .mono {
            font-family: var(--font-mono);
        }

        /* Slide layouts */
        .slide-center {
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .slide-title {
            background: radial-gradient(ellipse at center, var(--bg-secondary) 0%, var(--bg-deep) 100%);
        }

        .slide-title h1 {
            font-size: 4rem;
            background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 50%, var(--accent-magenta) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.5rem;
        }

        .slide-title .subtitle {
            font-size: 1.5rem;
            color: var(--text-secondary);
            font-weight: 300;
            margin-bottom: 3rem;
        }

        .slide-title .authors {
            font-size: 1.1rem;
            color: var(--text-muted);
        }

        /* Content layouts */
        .content-split {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(1rem, 3vmin, 3rem);
            flex: 1;
            align-items: start;
            min-height: 0;
        }

        .content-full {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Cards and boxes */
        .card {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .card-glow {
            box-shadow: 0 0 30px rgba(0, 217, 255, 0.1);
        }

        /* Lists */
        ul, ol {
            font-size: 1.2rem;
            line-height: 1.8;
            color: var(--text-secondary);
            padding-left: 1.5rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        li::marker {
            color: var(--accent-cyan);
        }

        /* Code blocks */
        .code-block {
            background: var(--bg-deep);
            border: 1px solid var(--bg-tertiary);
            border-radius: 8px;
            padding: 1.25rem;
            font-family: var(--font-mono);
            font-size: 0.95rem;
            line-height: 1.6;
            overflow-x: auto;
        }

        .code-block .keyword { color: var(--accent-purple); }
        .code-block .function { color: var(--accent-cyan); }
        .code-block .string { color: var(--accent-green); }
        .code-block .number { color: var(--accent-orange); }
        .code-block .comment { color: var(--text-muted); font-style: italic; }

        /* Math display */
        .math-block {
            background: var(--bg-secondary);
            border-left: 3px solid var(--accent-purple);
            padding: 1.5rem 2rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
            font-size: 1.3rem;
        }

        /* Dimension badges */
        .dim-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-cyan);
            border-radius: 20px;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--accent-cyan);
            margin: 0 0.25rem;
        }

        /* Highlight boxes */
        .highlight-box {
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
        }

        .highlight-cyan {
            background: rgba(0, 217, 255, 0.1);
            border: 1px solid rgba(0, 217, 255, 0.3);
        }

        .highlight-purple {
            background: rgba(163, 113, 247, 0.1);
            border: 1px solid rgba(163, 113, 247, 0.3);
        }

        .highlight-green {
            background: rgba(63, 185, 80, 0.1);
            border: 1px solid rgba(63, 185, 80, 0.3);
        }

        .highlight-orange {
            background: rgba(210, 153, 34, 0.1);
            border: 1px solid rgba(210, 153, 34, 0.3);
        }

        /* Progress bar */
        .progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            height: 3px;
            background: var(--gradient-cyan);
            transition: width 0.3s ease;
            z-index: 1000;
        }

        /* Slide counter */
        .slide-counter {
            position: fixed;
            bottom: 20px;
            right: 30px;
            font-family: var(--font-mono);
            font-size: 0.9rem;
            color: var(--text-muted);
            z-index: 1000;
        }

        /* Navigation hints */
        .nav-hint {
            position: fixed;
            bottom: 20px;
            left: 30px;
            font-size: 0.85rem;
            color: var(--text-muted);
            z-index: 1000;
        }

        .nav-hint kbd {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--bg-card);
            border-radius: 4px;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            margin: 0 0.2rem;
        }

        /* ===================== */
        /* SVG DIAGRAM STYLES    */
        /* ===================== */

        .diagram-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .diagram-container svg {
            max-width: 100%;
            max-height: 100%;
        }

        /* SVG styling */
        .svg-node {
            transition: all 0.3s ease;
        }

        .svg-node:hover {
            filter: brightness(1.2);
        }

        .svg-text {
            font-family: var(--font-display);
            fill: var(--text-primary);
        }

        .svg-text-mono {
            font-family: var(--font-mono);
        }

        .svg-text-dim {
            fill: var(--text-muted);
            font-size: 12px;
        }

        /* Animated flow lines */
        .flow-line {
            stroke-dasharray: 8 4;
            animation: flowDash 1s linear infinite;
        }

        @keyframes flowDash {
            to { stroke-dashoffset: -12; }
        }

        /* Glow effects */
        .glow-cyan { filter: drop-shadow(0 0 8px rgba(0, 217, 255, 0.5)); }
        .glow-purple { filter: drop-shadow(0 0 8px rgba(163, 113, 247, 0.5)); }
        .glow-green { filter: drop-shadow(0 0 8px rgba(63, 185, 80, 0.5)); }
        .glow-orange { filter: drop-shadow(0 0 8px rgba(210, 153, 34, 0.5)); }

        /* Pulse animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        /* Fade in animations for slide content */
        .slide.active .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }

        .slide.active .fade-in-delay-1 { animation-delay: 0.1s; opacity: 0; }
        .slide.active .fade-in-delay-2 { animation-delay: 0.2s; opacity: 0; }
        .slide.active .fade-in-delay-3 { animation-delay: 0.3s; opacity: 0; }
        .slide.active .fade-in-delay-4 { animation-delay: 0.4s; opacity: 0; }
        .slide.active .fade-in-delay-5 { animation-delay: 0.5s; opacity: 0; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Section divider */
        .section-badge {
            display: inline-block;
            padding: clamp(0.2rem, 0.5vmin, 0.4rem) clamp(0.5rem, 1vmin, 1rem);
            background: var(--bg-tertiary);
            border-radius: 20px;
            font-size: clamp(0.65rem, 1.5vmin, 0.85rem);
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: clamp(0.3rem, 1vmin, 1rem);
            flex-shrink: 0;
        }

        /* Two-column layout */
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        /* Architecture boxes */
        .arch-box {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .arch-box-cyan {
            background: linear-gradient(135deg, rgba(0, 217, 255, 0.15) 0%, rgba(0, 217, 255, 0.05) 100%);
            border-left: 3px solid var(--accent-cyan);
        }

        .arch-box-purple {
            background: linear-gradient(135deg, rgba(163, 113, 247, 0.15) 0%, rgba(163, 113, 247, 0.05) 100%);
            border-left: 3px solid var(--accent-purple);
        }

        .arch-box-green {
            background: linear-gradient(135deg, rgba(63, 185, 80, 0.15) 0%, rgba(63, 185, 80, 0.05) 100%);
            border-left: 3px solid var(--accent-green);
        }

        .arch-box-orange {
            background: linear-gradient(135deg, rgba(210, 153, 34, 0.15) 0%, rgba(210, 153, 34, 0.05) 100%);
            border-left: 3px solid var(--accent-orange);
        }

        /* Feature list with icons */
        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .feature-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        /* Arrow connector */
        .arrow-down {
            text-align: center;
            color: var(--accent-cyan);
            font-size: 2rem;
            margin: 0.5rem 0;
        }

        /* Table styling */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1rem;
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        th {
            background: var(--bg-secondary);
            color: var(--accent-cyan);
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
        }

        tr:hover {
            background: var(--bg-secondary);
        }

        td code {
            font-family: var(--font-mono);
            background: var(--bg-tertiary);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="presentation">

        <!-- ==================== -->
        <!-- SLIDE 1: Title       -->
        <!-- ==================== -->
        <section class="slide slide-title slide-center active" data-slide="1">
            <div class="fade-in">
                <h1>LIPO</h1>
                <p class="subtitle">Latent Instruction Prompt Optimization</p>
            </div>
            <p class="authors fade-in fade-in-delay-2">
                Michal Pr≈Ø≈°ek
            </p>
            <div style="margin-top: 3rem;" class="fade-in fade-in-delay-3">
                <span class="dim-badge">768D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-magenta); color: var(--accent-magenta);">optimize</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-green); color: var(--accent-green);">Text</span>
            </div>

            <div class="fade-in fade-in-delay-4" style="position: absolute; bottom: 2rem; left: 50%; transform: translateX(-50%); max-width: 600px; text-align: center;">
                <p style="font-size: 0.75rem; color: var(--accent-orange); background: rgba(210,153,34,0.1); padding: 0.6rem 1rem; border-radius: 6px; border: 1px solid rgba(210,153,34,0.3);">
                    ‚ö†Ô∏è <strong>Work in Progress</strong> ‚Äî This is the latest version. Some parameters (e.g., latent dimension, acquisition function) may change.
                </p>
            </div>
        </section>

        <!-- ==================== -->
        <!-- SLIDE 2: Motivation  -->
        <!-- ==================== -->
        <section class="slide" data-slide="2">
            <span class="section-badge fade-in">Introduction</span>
            <h2 class="fade-in fade-in-delay-1">Motivation</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3 style="color: var(--accent-orange);">The Problem</h3>
                    <ul>
                        <li>Manual prompt engineering is <strong>time-consuming</strong></li>
                        <li>Discrete text space is <strong>non-differentiable</strong></li>
                        <li>Evaluation requires <strong>expensive LLM calls</strong></li>
                        <li>Search space is <strong>combinatorially large</strong></li>
                    </ul>

                    <div class="highlight-box highlight-orange" style="margin-top: 2rem;">
                        <p style="font-size: 1.1rem; color: var(--text-primary);">
                            <strong>Challenge:</strong> How to efficiently optimize prompts when each evaluation costs significant compute?
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3 style="color: var(--accent-green);">Our Solution: LIPO</h3>
                    <ul>
                        <li>Map prompts to <strong>continuous latent space</strong></li>
                        <li>Use <strong>Bayesian Optimization</strong> for sample efficiency</li>
                        <li>Apply <strong>multi-fidelity</strong> evaluation (Hyperband)</li>
                        <li>Invert latents back to text via <strong>Vec2Text</strong></li>
                    </ul>

                    <div class="highlight-box highlight-green" style="margin-top: 2rem;">
                        <p style="font-size: 1.1rem; color: var(--text-primary);">
                            <strong>Result:</strong> Efficient gradient-based optimization in latent space with text generation
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 4: Architecture     -->
        <!-- ========================= -->
        <section class="slide" data-slide="4" style="padding: 30px 40px;">
            <h2 class="fade-in" style="text-align: center; margin-bottom: 0.5rem; font-size: 2rem;">LIPO Architecture</h2>

            <div class="diagram-container fade-in fade-in-delay-1" style="flex: 1; padding: 0;">
                <svg viewBox="0 0 1200 520" xmlns="http://www.w3.org/2000/svg">
                    <!-- Definitions -->
                    <defs>
                        <!-- Gradients -->
                        <linearGradient id="gradCyan" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#00d9ff;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#0099cc;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradPurple" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#a371f7;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#8957e5;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradGreen" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#3fb950;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#238636;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradOrange" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#d29922;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#bb8009;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradMagenta" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#f778ba;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#db61a2;stop-opacity:1" />
                        </linearGradient>

                        <!-- Glow filters -->
                        <filter id="glowCyan" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                            <feMerge>
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                        <filter id="glowPurple" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                            <feMerge>
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>

                        <!-- Arrow markers -->
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff"/>
                        </marker>
                        <marker id="arrowheadCyan" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#00d9ff"/>
                        </marker>
                        <marker id="arrowheadPurple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#a371f7"/>
                        </marker>
                        <marker id="arrowheadOrange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#d29922"/>
                        </marker>
                        <marker id="arrowheadGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#3fb950"/>
                        </marker>
                    </defs>

                    <!-- Centered content wrapper -->
                    <g transform="translate(115, 0)">

                    <!-- Training Instructions (input) -->
                    <g class="svg-node">
                        <rect x="30" y="160" width="160" height="40" rx="6" fill="rgba(142,142,142,0.2)" stroke="#8b949e" stroke-width="2"/>
                        <text x="110" y="177" text-anchor="middle" fill="#8b949e" font-size="10" font-weight="500" font-family="Outfit">Training Instructions</text>
                        <text x="110" y="191" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">(2000 samples)</text>
                    </g>

                    <!-- Arrow from Training Instructions to GTR -->
                    <line x1="110" y1="200" x2="110" y2="260" stroke="#8b949e" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- PHASE 1: GTR -->
                    <g class="svg-node" filter="url(#glowCyan)">
                        <rect x="30" y="260" width="160" height="70" rx="8" fill="url(#gradCyan)" opacity="0.9"/>
                        <text x="110" y="290" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="Outfit">GTR Encoder</text>
                        <text x="110" y="310" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="JetBrains Mono">768D embeddings</text>
                    </g>

                    <!-- Arrow to VAE Encoder -->
                    <line x1="190" y1="295" x2="300" y2="295" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                    <!-- PHASE 2: VAE -->
                    <g class="svg-node" filter="url(#glowPurple)">
                        <rect x="250" y="220" width="180" height="170" rx="8" fill="#161b22" stroke="url(#gradPurple)" stroke-width="2"/>

                        <!-- VAE Internal -->
                        <text x="340" y="245" text-anchor="middle" fill="#a371f7" font-size="14" font-weight="600" font-family="Outfit">VAE</text>

                        <!-- Encoder block (top left) -->
                        <rect x="265" y="260" width="70" height="45" rx="4" fill="rgba(163,113,247,0.3)"/>
                        <text x="300" y="278" text-anchor="middle" fill="#e6edf3" font-size="10" font-family="Outfit">Encoder</text>
                        <text x="300" y="293" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">768‚Üí32</text>

                        <!-- Arrow from Encoder down to z -->
                        <line x1="300" y1="305" x2="300" y2="325" stroke="#a371f7" stroke-width="1.5"/>
                        <line x1="300" y1="325" x2="320" y2="325" stroke="#a371f7" stroke-width="1.5" marker-end="url(#arrowheadPurple)"/>

                        <!-- Latent z (bottom center) -->
                        <rect x="320" y="310" width="40" height="30" rx="4" fill="#a371f7"/>
                        <text x="340" y="330" text-anchor="middle" fill="#0a0e14" font-size="10" font-weight="600" font-family="JetBrains Mono">z</text>

                        <!-- Arrow from z up to Decoder -->
                        <line x1="360" y1="325" x2="380" y2="325" stroke="#d29922" stroke-width="1.5"/>
                        <line x1="380" y1="325" x2="380" y2="305" stroke="#d29922" stroke-width="1.5" marker-end="url(#arrowheadOrange)"/>

                        <!-- Decoder block (top right) -->
                        <rect x="345" y="260" width="70" height="45" rx="4" fill="rgba(163,113,247,0.3)"/>
                        <text x="380" y="278" text-anchor="middle" fill="#e6edf3" font-size="10" font-family="Outfit">Decoder</text>
                        <text x="380" y="293" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">32‚Üí768</text>

                    </g>

                    <!-- Path from Decoder to Vec2Text (above VAE, orange) -->
                    <path d="M 415 280 L 440 280 L 440 90" fill="none" stroke="#d29922" stroke-width="2" marker-end="url(#arrowheadOrange)"/>

                    <!-- OUTPUT (same level as Vec2Text) -->
                    <g class="svg-node" filter="url(#glowCyan)">
                        <rect x="30" y="40" width="160" height="60" rx="8" fill="url(#gradGreen)" opacity="0.9"/>
                        <text x="110" y="65" text-anchor="middle" fill="#0a0e14" font-size="12" font-weight="600" font-family="Outfit">Optimized</text>
                        <text x="110" y="82" text-anchor="middle" fill="#0a0e14" font-size="12" font-weight="600" font-family="Outfit">Instruction</text>
                    </g>

                    <!-- Arrow from Vec2Text to Output (horizontal, orange) -->
                    <line x1="390" y1="70" x2="190" y2="70" stroke="#d29922" stroke-width="2" marker-end="url(#arrowheadOrange)"/>

                    <!-- Vec2Text (right, above VAE) -->
                    <g class="svg-node">
                        <rect x="390" y="50" width="100" height="40" rx="6" fill="rgba(210,153,34,0.2)" stroke="#d29922" stroke-width="2"/>
                        <text x="440" y="75" text-anchor="middle" fill="#d29922" font-size="11" font-weight="500" font-family="Outfit">Vec2Text</text>
                    </g>

                    <!-- Arrow from z (latent) right-bottom to GP -->
                    <path d="M 360 335 L 450 335 L 450 380 L 490 380" fill="none" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowheadGreen)"/>

                    <!-- PHASE 3: Hyperband + GP -->
                    <g class="svg-node">
                        <rect x="490" y="160" width="200" height="130" rx="8" fill="#161b22" stroke="url(#gradGreen)" stroke-width="2"/>
                        <text x="590" y="185" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="600" font-family="Outfit">Hyperband</text>
                        <text x="590" y="205" text-anchor="middle" fill="#8b949e" font-size="11" font-family="Outfit">Successive Halving + BO</text>

                        <!-- Mini brackets visualization -->
                        <rect x="510" y="220" width="30" height="25" rx="3" fill="rgba(63,185,80,0.4)"/>
                        <rect x="545" y="225" width="25" height="20" rx="3" fill="rgba(63,185,80,0.5)"/>
                        <rect x="575" y="230" width="20" height="15" rx="3" fill="rgba(63,185,80,0.6)"/>
                        <rect x="600" y="235" width="15" height="10" rx="2" fill="#3fb950"/>

                        <text x="590" y="270" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">Œ∑=2, fidelity: 10‚Üí1319</text>
                    </g>

                    <!-- Arrow down to GP -->
                    <line x1="590" y1="290" x2="590" y2="320" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowheadGreen)"/>

                    <g class="svg-node">
                        <rect x="490" y="330" width="200" height="100" rx="8" fill="#161b22" stroke="url(#gradGreen)" stroke-width="2"/>
                        <text x="590" y="360" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="600" font-family="Outfit">Gaussian Process</text>
                        <text x="590" y="380" text-anchor="middle" fill="#8b949e" font-size="11" font-family="Outfit">ARD Mat√©rn 5/2 Kernel</text>
                        <text x="590" y="400" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">32 lengthscales</text>
                        <text x="590" y="418" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">‚Üí UCB acquisition</text>
                    </g>

                    <!-- Arrow to Optimization Loop -->
                    <line x1="690" y1="380" x2="740" y2="380" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowheadGreen)"/>

                    <!-- Optimization Loop (formerly InvBO) -->
                    <g class="svg-node">
                        <rect x="750" y="140" width="220" height="300" rx="8" fill="#161b22" stroke="url(#gradOrange)" stroke-width="2"/>
                        <text x="860" y="170" text-anchor="middle" fill="#d29922" font-size="14" font-weight="600" font-family="Outfit">Optimization Loop</text>

                        <!-- UCB Acquisition -->
                        <rect x="770" y="200" width="180" height="55" rx="6" fill="rgba(88,166,255,0.2)" stroke="#58a6ff" stroke-width="1"/>
                        <text x="860" y="222" text-anchor="middle" fill="#58a6ff" font-size="12" font-weight="500" font-family="Outfit">UCB Acquisition</text>
                        <text x="860" y="240" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">Œ≤=8.0, 64 restarts</text>

                        <!-- Vec2Text Inversion -->
                        <rect x="770" y="270" width="180" height="55" rx="6" fill="rgba(247,120,186,0.2)" stroke="#f778ba" stroke-width="1"/>
                        <text x="860" y="292" text-anchor="middle" fill="#f778ba" font-size="12" font-weight="500" font-family="Outfit">Vec2Text Inversion</text>
                        <text x="860" y="310" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">768D ‚Üí text</text>

                        <!-- Candidate Rejection -->
                        <rect x="770" y="340" width="180" height="55" rx="6" fill="rgba(63,185,80,0.2)" stroke="#3fb950" stroke-width="1"/>
                        <text x="860" y="362" text-anchor="middle" fill="#3fb950" font-size="12" font-weight="500" font-family="Outfit">Candidate Rejection</text>
                        <text x="860" y="380" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">cosine ‚â• 0.90</text>

                    </g>

                    <!-- Arrow from Optimization Loop back to z (z* candidate) -->
                    <path d="M 780 440 L 780 460 L 340 460 L 340 340" fill="none" stroke="#d29922" stroke-width="2" marker-end="url(#arrowheadOrange)"/>
                    <text x="560" y="475" fill="#d29922" font-size="10" font-family="Outfit">z* candidate</text>

                    </g><!-- End centered content wrapper -->

                </svg>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 6: APE Generation   -->
        <!-- ========================= -->
        <section class="slide" data-slide="6">
            <h2 class="fade-in fade-in-delay-1">APE: Automatic Prompt Engineering</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3 style="margin-bottom: 0.5rem;">8 Style Categories</h3>
                    <table style="font-size: 0.85rem;">
                        <tbody>
                            <tr>
                                <td><code>minimalist</code></td>
                                <td style="color: var(--text-muted);">"Solve. Show answer."</td>
                            </tr>
                            <tr>
                                <td><code>direct_command</code></td>
                                <td style="color: var(--text-muted);">"Read problem. Identify knowns. Apply formula. Compute."</td>
                            </tr>
                            <tr>
                                <td><code>chain_of_thought</code></td>
                                <td style="color: var(--text-muted);">"Let's approach this systematically. First, identify what we need..."</td>
                            </tr>
                            <tr>
                                <td><code>pedagogical</code></td>
                                <td style="color: var(--text-muted);">"Explain as if teaching a struggling student, step by step..."</td>
                            </tr>
                            <tr>
                                <td><code>analytical</code></td>
                                <td style="color: var(--text-muted);">"Decompose into components. Analyze variable dependencies..."</td>
                            </tr>
                            <tr>
                                <td><code>persona_roleplay</code></td>
                                <td style="color: var(--text-muted);">"You are a Fields Medal winner reviewing an olympiad problem..."</td>
                            </tr>
                            <tr>
                                <td><code>programmatic</code></td>
                                <td style="color: var(--text-muted);">"INPUT: eq; PROC: parse() ‚Üí solve(); OUTPUT: result"</td>
                            </tr>
                            <tr>
                                <td><code>adversarial</code></td>
                                <td style="color: var(--text-muted);">"Challenge assumptions. Test edge cases. Verify rigorously."</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>2-Level Augmentation</h3>
                    <div class="card" style="margin-bottom: 0.8rem; padding: 0.8rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 0.3rem;">L1: Base Generation</h4>
                        <p style="font-size: 0.9rem;">3 random Q/A pairs + style template ‚Üí 2000 base instructions</p>
                    </div>
                    <div class="card" style="padding: 0.8rem;">
                        <h4 style="color: var(--accent-purple); margin-bottom: 0.3rem;">L2: LLM Paraphrasing (30%)</h4>
                        <p style="font-size: 0.9rem;">Rephrase while preserving semantic meaning</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 7: GTR Encoder      -->
        <!-- ========================= -->
        <section class="slide" data-slide="7">
            <h2 class="fade-in fade-in-delay-1">GTR Encoder</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>SentenceTransformer GTR-T5-Base</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Produces L2-normalized 768D embeddings compatible with Vec2Text inversion.
                    </p>

                    <ul class="feature-list">
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üìê</div>
                            <div>
                                <strong>768-dimensional</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Dense semantic representation</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üîÑ</div>
                            <div>
                                <strong>L2-normalized</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Required for Vec2Text compatibility</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üß†</div>
                            <div>
                                <strong>110M parameters</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">T5-Base encoder only</p>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 300px;">
                        <svg viewBox="0 0 400 280" xmlns="http://www.w3.org/2000/svg">
                            <!-- Input text -->
                            <rect x="50" y="20" width="300" height="50" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                            <text x="200" y="50" text-anchor="middle" fill="#e6edf3" font-size="14" font-family="Outfit">"Solve the problem step by step"</text>

                            <!-- Arrow -->
                            <line x1="200" y1="70" x2="200" y2="100" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                            <!-- GTR box -->
                            <rect x="100" y="110" width="200" height="60" rx="8" fill="url(#gradCyan)"/>
                            <text x="200" y="135" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="Outfit">GTR-T5-Base</text>
                            <text x="200" y="155" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="JetBrains Mono">SentenceTransformer</text>

                            <!-- Arrow -->
                            <line x1="200" y1="170" x2="200" y2="200" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                            <!-- Output embedding -->
                            <rect x="50" y="210" width="300" height="50" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                            <text x="200" y="235" text-anchor="middle" fill="#00d9ff" font-size="12" font-family="JetBrains Mono">[0.023, -0.118, ..., 0.045]</text>
                            <text x="200" y="252" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">768D, ||x||‚ÇÇ = 1</text>
                        </svg>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 8: VAE Architecture -->
        <!-- ========================= -->
        <section class="slide" data-slide="8">
            <h2 class="fade-in fade-in-delay-1">VAE Architecture</h2>

            <div class="diagram-container fade-in fade-in-delay-2" style="flex: 1; display: flex; justify-content: center; align-items: center; width: 100%;">
                <svg viewBox="0 0 950 350" style="width: 100%; max-height: 70vh; height: auto;" xmlns="http://www.w3.org/2000/svg">
                    <!-- Title -->

                    <!-- ENCODER SIDE -->
                    <text x="250" y="50" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">ENCODER</text>

                    <!-- Input layer -->
                    <rect x="20" y="100" width="80" height="200" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                    <text x="60" y="140" text-anchor="middle" fill="#00d9ff" font-size="12" font-weight="500" font-family="Outfit">Input</text>
                    <text x="60" y="200" text-anchor="middle" fill="#00d9ff" font-size="20" font-weight="600" font-family="JetBrains Mono">768</text>
                    <text x="60" y="270" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">GTR</text>

                    <!-- Arrow -->
                    <line x1="100" y1="200" x2="115" y2="200" stroke="#00d9ff" stroke-width="2"/>

                    <!-- Hidden 1: 512 -->
                    <rect x="120" y="115" width="55" height="170" rx="6" fill="rgba(163,113,247,0.25)" stroke="#a371f7" stroke-width="1"/>
                    <text x="147" y="185" text-anchor="middle" fill="#a371f7" font-size="16" font-weight="600" font-family="JetBrains Mono">512</text>
                    <text x="147" y="210" text-anchor="middle" fill="#8b949e" font-size="8" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="175" y1="200" x2="190" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 2: 256 -->
                    <rect x="195" y="130" width="50" height="140" rx="6" fill="rgba(163,113,247,0.35)" stroke="#a371f7" stroke-width="1"/>
                    <text x="220" y="185" text-anchor="middle" fill="#a371f7" font-size="16" font-weight="600" font-family="JetBrains Mono">256</text>
                    <text x="220" y="210" text-anchor="middle" fill="#8b949e" font-size="8" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="245" y1="200" x2="260" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 3: 128 -->
                    <rect x="265" y="145" width="45" height="110" rx="6" fill="rgba(163,113,247,0.45)" stroke="#a371f7" stroke-width="1"/>
                    <text x="287" y="190" text-anchor="middle" fill="#a371f7" font-size="14" font-weight="600" font-family="JetBrains Mono">128</text>
                    <text x="287" y="210" text-anchor="middle" fill="#8b949e" font-size="8" font-family="Outfit">GELU+LN</text>

                    <!-- Arrows to Œº and log œÉ¬≤ -->
                    <path d="M 310 200 L 330 200 L 350 140" fill="none" stroke="#a371f7" stroke-width="2"/>
                    <path d="M 310 200 L 330 200 L 350 260" fill="none" stroke="#a371f7" stroke-width="2"/>

                    <!-- Mu -->
                    <rect x="350" y="100" width="50" height="70" rx="6" fill="rgba(163,113,247,0.5)" stroke="#a371f7" stroke-width="2"/>
                    <text x="375" y="125" text-anchor="middle" fill="#e6edf3" font-size="14" font-weight="600" font-family="Outfit">Œº</text>
                    <text x="375" y="155" text-anchor="middle" fill="#a371f7" font-size="14" font-family="JetBrains Mono">32</text>

                    <!-- LogVar -->
                    <rect x="350" y="230" width="50" height="70" rx="6" fill="rgba(163,113,247,0.5)" stroke="#a371f7" stroke-width="2"/>
                    <text x="375" y="255" text-anchor="middle" fill="#e6edf3" font-size="12" font-weight="600" font-family="Outfit">log œÉ¬≤</text>
                    <text x="375" y="280" text-anchor="middle" fill="#a371f7" font-size="14" font-family="JetBrains Mono">32</text>

                    <!-- Reparameterization -->
                    <rect x="410" y="170" width="100" height="60" rx="6" fill="rgba(210,153,34,0.3)" stroke="#d29922" stroke-width="2"/>
                    <text x="460" y="205" text-anchor="middle" fill="#d29922" font-size="10" font-weight="600" font-family="JetBrains Mono">z = Œº + œÉ ¬∑ Œµ</text>

                    <!-- Arrows from Œº and log œÉ¬≤ to reparam -->
                    <path d="M 400 135 L 410 135 L 410 170" fill="none" stroke="#a371f7" stroke-width="2"/>
                    <path d="M 400 265 L 410 265 L 410 230" fill="none" stroke="#a371f7" stroke-width="2"/>

                    <!-- Latent z -->
                    <rect x="540" y="155" width="60" height="90" rx="6" fill="#a371f7"/>
                    <text x="570" y="185" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="Outfit">Latent</text>
                    <text x="570" y="215" text-anchor="middle" fill="#0a0e14" font-size="18" font-weight="600" font-family="JetBrains Mono">32</text>

                    <!-- Arrow from reparam -->
                    <line x1="510" y1="200" x2="540" y2="200" stroke="#d29922" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- DECODER SIDE -->
                    <text x="700" y="50" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">DECODER</text>

                    <!-- Arrow to decoder -->
                    <line x1="600" y1="200" x2="620" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 1 (decoder): 128 -->
                    <rect x="625" y="145" width="45" height="110" rx="6" fill="rgba(163,113,247,0.45)" stroke="#a371f7" stroke-width="1"/>
                    <text x="647" y="190" text-anchor="middle" fill="#a371f7" font-size="14" font-weight="600" font-family="JetBrains Mono">128</text>
                    <text x="647" y="210" text-anchor="middle" fill="#8b949e" font-size="8" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="670" y1="200" x2="685" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 2 (decoder): 256 -->
                    <rect x="690" y="130" width="50" height="140" rx="6" fill="rgba(163,113,247,0.35)" stroke="#a371f7" stroke-width="1"/>
                    <text x="715" y="185" text-anchor="middle" fill="#a371f7" font-size="16" font-weight="600" font-family="JetBrains Mono">256</text>
                    <text x="715" y="210" text-anchor="middle" fill="#8b949e" font-size="8" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="740" y1="200" x2="755" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 3 (decoder): 512 -->
                    <rect x="760" y="115" width="55" height="170" rx="6" fill="rgba(163,113,247,0.25)" stroke="#a371f7" stroke-width="1"/>
                    <text x="787" y="185" text-anchor="middle" fill="#a371f7" font-size="16" font-weight="600" font-family="JetBrains Mono">512</text>
                    <text x="787" y="210" text-anchor="middle" fill="#8b949e" font-size="8" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="815" y1="200" x2="830" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Output layer -->
                    <rect x="835" y="100" width="80" height="200" rx="8" fill="rgba(63,185,80,0.2)" stroke="#3fb950" stroke-width="2"/>
                    <text x="875" y="140" text-anchor="middle" fill="#3fb950" font-size="12" font-weight="500" font-family="Outfit">Output</text>
                    <text x="875" y="200" text-anchor="middle" fill="#3fb950" font-size="20" font-weight="600" font-family="JetBrains Mono">768</text>
                    <text x="875" y="270" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">L2 norm</text>

                </svg>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 9: VAE Loss         -->
        <!-- ========================= -->
        <section class="slide" data-slide="9">
            <h2 class="fade-in fade-in-delay-1">VAE Loss Function</h2>

            <!-- Total Loss at top center -->
            <div class="fade-in fade-in-delay-2" style="text-align: center; margin-bottom: 1.5rem;">
                <h3 style="margin-bottom: 0.5rem; font-size: 1.4rem; color: var(--accent-cyan);">Total Loss</h3>
                <div class="math-block" style="margin: 0 auto 0.5rem auto; padding: 1.2rem 2rem; max-width: 750px; font-size: 1.5rem; background: linear-gradient(135deg, rgba(0,217,255,0.1) 0%, rgba(163,113,247,0.1) 100%); border: 2px solid var(--accent-cyan); border-radius: 12px;">
                    $$\mathcal{L} = (1-w)\cdot\mathcal{L}_{\text{cos}} + w\cdot\mathcal{L}_{\text{MSE}} + \beta \cdot \mathcal{L}_{\text{KL}}$$
                </div>
                <p style="font-size: 0.9rem; color: var(--text-secondary);">
                    <strong>w</strong> = MSE weight (0.2), <strong>Œ≤</strong> = KL weight (0.005)
                </p>
            </div>

            <div class="content-split" style="gap: 1.5rem; align-items: start;">
                <!-- Parameters on the left -->
                <div class="fade-in fade-in-delay-3">
                    <h3 style="margin-bottom: 0.4rem; font-size: 1rem;">Parameters</h3>
                    <table style="font-size: 0.8rem;">
                        <tr>
                            <td><code>Œ≤</code></td>
                            <td style="color: var(--accent-purple);">0.005</td>
                            <td>KL weight (lowered)</td>
                        </tr>
                        <tr>
                            <td><code>mse_weight</code></td>
                            <td style="color: var(--accent-orange);">0.2</td>
                            <td>MSE vs cosine</td>
                        </tr>
                        <tr>
                            <td><code>epochs</code></td>
                            <td style="color: var(--accent-green);">50000</td>
                            <td>Max epochs</td>
                        </tr>
                        <tr>
                            <td><code>lr</code></td>
                            <td style="color: var(--accent-cyan);">0.0006</td>
                            <td>Learning rate</td>
                        </tr>
                        <tr>
                            <td><code>patience</code></td>
                            <td style="color: var(--accent-orange);">1000</td>
                            <td>Early stop</td>
                        </tr>
                    </table>

                </div>

                <!-- Loss terms explanation on the right -->
                <div class="fade-in fade-in-delay-3">
                    <h3 style="margin-bottom: 0.4rem; font-size: 1rem;">Loss Terms</h3>
                    <div class="card" style="padding: 0.5rem; margin-bottom: 0.4rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 0.3rem; font-size: 0.85rem;">Cosine Loss</h4>
                        <div class="math-block" style="margin: 0; padding: 0.3rem; font-size: 0.85rem;">
                            $$\mathcal{L}_{\text{cos}} = 1 - \cos(\hat{e}, e)$$
                        </div>
                        <p style="margin-top: 0.3rem; font-size: 0.7rem; color: var(--text-muted);">
                            Measures directional similarity between reconstructed and original embedding
                        </p>
                    </div>

                    <div class="card" style="padding: 0.5rem;">
                        <h4 style="color: var(--accent-purple); margin-bottom: 0.3rem; font-size: 0.85rem;">KL Divergence</h4>
                        <div class="math-block" style="margin: 0; padding: 0.3rem; font-size: 0.9rem;">
                            $$\mathcal{L}_{\text{KL}} = -\frac{1}{2}\sum_i \left(1 + \log\sigma_i^2 - \mu_i^2 - \sigma_i^2\right)$$
                        </div>
                        <p style="margin-top: 0.3rem; font-size: 0.7rem; color: var(--text-muted);">
                            <strong>Œº<sub>i</sub></strong> = mean, <strong>œÉ<sub>i</sub></strong> = std
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 10: KL Annealing    -->
        <!-- ========================= -->
        <section class="slide" data-slide="10">
            <h2 class="fade-in fade-in-delay-1">KL Annealing</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Annealing Schedule</h3>
                    <div class="math-block">
                        $$\beta(t) = \begin{cases} \beta_{\max} \cdot \frac{t}{T_{\text{anneal}}} & t < T_{\text{anneal}} \\ \beta_{\max} = 0.005 & t \geq T_{\text{anneal}} \end{cases}$$
                    </div>
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                        <strong>Œ≤(t)</strong> = KL weight at epoch t, <strong>T<sub>anneal</sub></strong> = warmup epochs, <strong>Œ≤<sub>max</sub></strong> = final weight
                    </p>

                    <div class="highlight-box highlight-orange" style="margin-top: 1rem;">
                        <strong>Why annealing?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Prevents <em>posterior collapse</em>: early training focuses on reconstruction, then gradually enforces smooth latent structure.
                        </p>
                    </div>

                    <table style="margin-top: 1.5rem;">
                        <tr>
                            <td><code>annealing_epochs</code></td>
                            <td style="color: var(--accent-orange);">2500</td>
                        </tr>
                        <tr>
                            <td><code>Œ≤_max</code></td>
                            <td style="color: var(--accent-purple);">0.005</td>
                        </tr>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 300px;">
                        <svg viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                            <!-- Axes -->
                            <line x1="50" y1="250" x2="380" y2="250" stroke="#6e7681" stroke-width="2"/>
                            <line x1="50" y1="250" x2="50" y2="30" stroke="#6e7681" stroke-width="2"/>

                            <!-- Labels -->
                            <text x="215" y="280" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">Epoch</text>
                            <text x="20" y="140" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit" transform="rotate(-90, 20, 140)">Œ≤</text>

                            <!-- Y-axis labels -->
                            <text x="40" y="255" text-anchor="end" fill="#6e7681" font-size="10" font-family="JetBrains Mono">0</text>
                            <text x="40" y="55" text-anchor="end" fill="#6e7681" font-size="10" font-family="JetBrains Mono">0.005</text>

                            <!-- X-axis labels -->
                            <text x="50" y="265" text-anchor="middle" fill="#6e7681" font-size="10" font-family="JetBrains Mono">0</text>
                            <text x="115" y="265" text-anchor="middle" fill="#6e7681" font-size="10" font-family="JetBrains Mono">2500</text>
                            <text x="380" y="265" text-anchor="middle" fill="#6e7681" font-size="10" font-family="JetBrains Mono">50000</text>

                            <!-- Annealing line -->
                            <path d="M 50 250 L 115 50 L 380 50" fill="none" stroke="#a371f7" stroke-width="3"/>

                            <!-- Annealing region -->
                            <rect x="50" y="50" width="65" height="200" fill="rgba(210,153,34,0.1)"/>
                            <text x="82" y="150" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">Annealing</text>

                            <!-- Max Œ≤ line -->
                            <line x1="50" y1="50" x2="380" y2="50" stroke="#a371f7" stroke-width="1" stroke-dasharray="5,5" opacity="0.5"/>
                            <text x="390" y="55" fill="#a371f7" font-size="10" font-family="JetBrains Mono">Œ≤_max</text>

                            <!-- Point at transition -->
                            <circle cx="115" cy="50" r="5" fill="#d29922"/>
                            <text x="115" y="35" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">T=2500</text>
                        </svg>
                    </div>

                    <div class="card" style="margin-top: 1rem;">
                        <p style="font-size: 1rem;">
                            <strong style="color: var(--accent-cyan);">Epochs 0-2500:</strong> Œ≤ ramps up linearly (5% warmup)<br>
                            <strong style="color: var(--accent-purple);">Epochs 2500+:</strong> Œ≤ = 0.005 (constant)
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 13: Hyperband      -->
        <!-- ========================= -->
        <section class="slide" data-slide="13">
            <h2 class="fade-in fade-in-delay-1">Hyperband</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Successive Halving + BO</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Efficient multi-fidelity evaluation combining Hyperband scheduling with Bayesian Optimization proposals.
                    </p>

                    <div class="math-block">
                        $$r = \frac{n_{\text{valid}}}{b_{\min}}, \quad s_{\max} = \lfloor \frac{\log r}{\log \eta} \rfloor$$
                    </div>
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                        <strong>r</strong> = budget ratio, <strong>n<sub>valid</sub></strong> = validation samples, <strong>b<sub>min</sub></strong> = min fidelity, <strong>s<sub>max</sub></strong> = max rungs, <strong>Œ∑</strong> = halving rate
                    </p>

                    <table style="margin-top: 1rem;">
                        <tr>
                            <td><code>bmin</code></td>
                            <td style="color: var(--accent-cyan);">10</td>
                            <td>Minimum fidelity (samples)</td>
                        </tr>
                        <tr>
                            <td><code>Œ∑</code></td>
                            <td style="color: var(--accent-purple);">2.0</td>
                            <td>Downsampling rate</td>
                        </tr>
                        <tr>
                            <td><code>max fidelity</code></td>
                            <td style="color: var(--accent-green);">1319</td>
                            <td>Full validation set</td>
                        </tr>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 300px;">
                        <svg viewBox="0 0 400 280" xmlns="http://www.w3.org/2000/svg">
                            <!-- Successive halving visualization -->
                            <text x="200" y="25" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">Successive Halving Schedule</text>

                            <!-- Stage 0 -->
                            <rect x="30" y="50" width="340" height="35" rx="4" fill="rgba(63,185,80,0.2)" stroke="#3fb950"/>
                            <text x="50" y="73" fill="#3fb950" font-size="11" font-family="Outfit">Stage 0: n instructions @ 10 samples</text>

                            <!-- Stage 1 -->
                            <rect x="60" y="95" width="280" height="35" rx="4" fill="rgba(63,185,80,0.3)" stroke="#3fb950"/>
                            <text x="80" y="118" fill="#3fb950" font-size="11" font-family="Outfit">Stage 1: n/2 instructions @ 20 samples</text>

                            <!-- Stage 2 -->
                            <rect x="90" y="140" width="220" height="35" rx="4" fill="rgba(63,185,80,0.4)" stroke="#3fb950"/>
                            <text x="110" y="163" fill="#3fb950" font-size="11" font-family="Outfit">Stage 2: n/4 @ 40 samples</text>

                            <!-- Stage 3 -->
                            <rect x="120" y="185" width="160" height="35" rx="4" fill="rgba(63,185,80,0.6)" stroke="#3fb950"/>
                            <text x="140" y="208" fill="#e6edf3" font-size="11" font-family="Outfit">... ‚Üí full fidelity</text>

                            <!-- Keep top arrow -->
                            <text x="200" y="250" text-anchor="middle" fill="#d29922" font-size="11" font-family="Outfit">Keep top performers at each stage</text>
                        </svg>
                    </div>

                    <div class="highlight-box highlight-green" style="margin-top: 0.5rem;">
                        <strong>BO Proposals:</strong> 90% EI, 10% Random
                    </div>
                    <div class="highlight-box highlight-orange" style="margin-top: 0.5rem;">
                        <strong>GP Training:</strong> ALL evaluations (not just top fidelity)
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 14: GP Architecture -->
        <!-- ========================= -->
        <section class="slide" data-slide="15">
            <h2 class="fade-in fade-in-delay-1">GP Architecture</h2>

            <!-- Pipeline Diagram -->
            <div class="fade-in fade-in-delay-2" style="display: flex; justify-content: center; align-items: center; gap: 0.8rem; margin-bottom: 1.2rem;">
                <div style="padding: 0.6rem 1rem; background: rgba(163,113,247,0.2); border: 2px solid #a371f7; border-radius: 8px; text-align: center;">
                    <div style="color: #a371f7; font-weight: 600;">32D Latent</div>
                </div>
                <span style="color: #a371f7; font-size: 1.3rem;">‚Üí</span>
                <div style="padding: 0.6rem 1rem; background: rgba(210,153,34,0.2); border: 2px solid #d29922; border-radius: 8px; text-align: center;">
                    <div style="color: #d29922; font-weight: 600;">Unit Cube Norm</div>
                </div>
                <span style="color: #d29922; font-size: 1.3rem;">‚Üí</span>
                <div style="padding: 0.6rem 1rem; background: rgba(163,113,247,0.2); border: 2px solid #a371f7; border-radius: 8px; text-align: center;">
                    <div style="color: #a371f7; font-weight: 600;">ARD</div>
                </div>
                <span style="color: #a371f7; font-size: 1.3rem;">‚Üí</span>
                <div style="padding: 0.6rem 1rem; background: rgba(63,185,80,0.2); border: 2px solid #3fb950; border-radius: 8px; text-align: center;">
                    <div style="color: #3fb950; font-weight: 600;">Mat√©rn 5/2</div>
                </div>
                <span style="color: #3fb950; font-size: 1.3rem;">‚Üí</span>
                <div style="padding: 0.6rem 1rem; background: rgba(88,166,255,0.2); border: 2px solid #58a6ff; border-radius: 8px; text-align: center;">
                    <div style="color: #58a6ff; font-weight: 600;">GP</div>
                </div>
                <span style="color: #58a6ff; font-size: 1.3rem;">‚Üí</span>
                <div style="display: flex; flex-direction: column; gap: 0.4rem;">
                    <div style="padding: 0.4rem 0.8rem; background: rgba(0,217,255,0.2); border: 2px solid #00d9ff; border-radius: 8px; text-align: center;">
                        <div style="color: #00d9ff; font-weight: 600;">Œº</div>
                    </div>
                    <div style="padding: 0.4rem 0.8rem; background: rgba(247,120,186,0.2); border: 2px solid #f778ba; border-radius: 8px; text-align: center;">
                        <div style="color: #f778ba; font-weight: 600;">œÉ¬≤</div>
                    </div>
                </div>
            </div>

            <!-- Row 1: 3 formulas - following architecture order -->
            <div class="fade-in fade-in-delay-2" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.6rem; margin-bottom: 0.6rem;">
                <div class="card" style="padding: 0.4rem; text-align: center;">
                    <h4 style="color: #a371f7; margin-bottom: 0.2rem; font-size: 0.8rem;">ARD Distance</h4>
                    <div class="math-block" style="padding: 0.2rem; font-size: 0.8rem;">
                        $$r^2 = \sum_{i=1}^{32} \frac{(x_i - x'_i)^2}{\ell_i^2}$$
                    </div>
                </div>

                <div class="card" style="padding: 0.4rem; text-align: center;">
                    <h4 style="color: #3fb950; margin-bottom: 0.2rem; font-size: 0.8rem;">Mat√©rn 5/2</h4>
                    <div class="math-block" style="padding: 0.2rem; font-size: 0.75rem;">
                        $$k(r) = \sigma^2 \left(1 + \sqrt{5}r + \frac{5r^2}{3}\right) e^{-\sqrt{5}r}$$
                    </div>
                </div>

                <div class="card" style="padding: 0.4rem; text-align: center;">
                    <h4 style="color: #58a6ff; margin-bottom: 0.2rem; font-size: 0.8rem;">GP Prior</h4>
                    <div class="math-block" style="padding: 0.2rem; font-size: 0.8rem;">
                        $$\mu(\mathbf{z}) \sim \mathcal{GP}(0, k)$$
                    </div>
                </div>
            </div>

            <!-- Row 2: 2 formulas centered - outputs -->
            <div class="fade-in fade-in-delay-3" style="display: flex; justify-content: center; gap: 0.6rem; margin-bottom: 0.6rem;">
                <div class="card" style="padding: 0.4rem; text-align: center; flex: 0 1 auto; min-width: 280px;">
                    <h4 style="color: #00d9ff; margin-bottom: 0.2rem; font-size: 0.8rem;">GP Mean (Œº)</h4>
                    <div class="math-block" style="padding: 0.2rem; font-size: 0.8rem;">
                        $$\mu^* = k_*^T (K + \sigma_n^2 I)^{-1} y$$
                    </div>
                </div>

                <div class="card" style="padding: 0.4rem; text-align: center; flex: 0 1 auto; min-width: 320px;">
                    <h4 style="color: #f778ba; margin-bottom: 0.2rem; font-size: 0.8rem;">GP Variance (œÉ¬≤)</h4>
                    <div class="math-block" style="padding: 0.2rem; font-size: 0.8rem;">
                        $$\sigma^{2*} = k_{**} - k_*^T (K + \sigma_n^2 I)^{-1} k_*$$
                    </div>
                </div>
            </div>

            <!-- Row 3: Objective Function -->
            <div class="fade-in fade-in-delay-3" style="margin-bottom: 0.6rem;">
                <div class="card" style="padding: 0.5rem; text-align: center;">
                    <h4 style="color: #d29922; margin-bottom: 0.3rem; font-size: 0.8rem;">Objective Function (Log Marginal Likelihood)</h4>
                    <div class="math-block" style="padding: 0.2rem; font-size: 0.65rem;">
                        $$\log p(y | X, \theta) = \underbrace{ -\frac{1}{2} y^\top (K_\theta + \sigma_n^2 I)^{-1} y }_{\text{Data Fit}} - \underbrace{ \frac{1}{2} \log |K_\theta + \sigma_n^2 I| }_{\text{Complexity Penalty}} - \frac{n}{2} \log 2\pi$$
                    </div>
                </div>
            </div>

            <!-- Learnable Parameters - compact -->
            <div class="fade-in fade-in-delay-4" style="display: flex; justify-content: center; gap: 2rem; align-items: center; padding: 0.6rem; background: rgba(22,27,34,0.8); border-radius: 10px; border: 1px solid var(--bg-tertiary);">
                <div style="text-align: center;">
                    <div style="color: #a371f7; font-weight: 600; font-size: 0.95rem;">32 ARD Lengthscales</div>
                    <div style="font-family: var(--font-mono); color: var(--text-secondary); font-size: 0.8rem;">‚Ñì‚ÇÅ, ‚Ñì‚ÇÇ, ..., ‚Ñì‚ÇÉ‚ÇÇ ‚àà ‚Ñù‚Å∫</div>
                </div>
                <div style="color: var(--text-muted); font-size: 1.3rem;">+</div>
                <div style="text-align: center;">
                    <div style="color: #3fb950; font-weight: 600; font-size: 0.95rem;">1 Kernel Scale</div>
                    <div style="font-family: var(--font-mono); color: var(--text-secondary); font-size: 0.8rem;">œÉ¬≤ ‚àà ‚Ñù‚Å∫</div>
                </div>
                <div style="color: var(--text-muted); font-size: 1.3rem;">=</div>
                <div style="padding: 0.4rem 0.8rem; background: rgba(63,185,80,0.2); border: 2px solid #3fb950; border-radius: 8px;">
                    <div style="color: #3fb950; font-weight: 700; font-size: 1rem;">33 parameters</div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 15: GP Training      -->
        <!-- ========================= -->
        <section class="slide" data-slide="16">
            <h2 class="fade-in fade-in-delay-1">GP Training with Heteroscedastic Noise</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Beta Posterior Variance</h3>
                    <p style="margin-bottom: 1rem;">
                        GP trains on ALL examples. Reliability via observation-specific noise based on Beta posterior.
                    </p>

                    <div class="math-block">
                        $$\text{Var}(p) = \frac{p(1-p)}{n + \alpha + \beta + 1}$$
                    </div>

                    <p style="margin-top: 0.75rem; font-size: 1rem;">
                        where $p$ = error rate, $n$ = samples, $\alpha, \beta$ = Empirical Bayes prior
                    </p>

                    <div class="highlight-box highlight-orange" style="margin-top: 1rem;">
                        <strong>Effect:</strong>
                        <p style="margin-top: 0.5rem; font-size: 0.95rem;">
                            Low fidelity ‚Üí high variance ‚Üí GP trusts less<br>
                            High fidelity ‚Üí low variance ‚Üí GP trusts more
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>GP Parameters</h3>
                    <table>
                        <tr>
                            <td><code>epochs</code></td>
                            <td style="color: var(--accent-cyan);">10000</td>
                            <td>Training epochs</td>
                        </tr>
                        <tr>
                            <td><code>lr</code></td>
                            <td style="color: var(--accent-purple);">0.0025</td>
                            <td>Scaled for 32D</td>
                        </tr>
                        <tr>
                            <td><code>patience</code></td>
                            <td style="color: var(--accent-green);">100</td>
                            <td>Early stopping</td>
                        </tr>
                    </table>

                    <h3 style="margin-top: 1rem;">Interactive Variance Calculator</h3>
                    <div class="variance-calculator" style="background: rgba(139, 148, 158, 0.1); border-radius: 8px; padding: 0.75rem;">
                        <div style="margin-bottom: 0.5rem; font-size: 0.75rem; color: var(--text-muted); text-align: center;">
                            Prior: Œ± = 2, Œ≤ = 11 (Empirical Bayes)
                        </div>
                        <div style="margin-bottom: 0.5rem;">
                            <label style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.25rem;">
                                <span style="font-size: 0.9rem;">Error rate <strong style="color: var(--accent-purple);">p</strong></span>
                                <code id="p-value" style="color: var(--accent-purple);">0.15</code>
                            </label>
                            <input type="range" id="p-slider" min="0.05" max="0.95" step="0.05" value="0.15"
                                   style="width: 100%; accent-color: var(--accent-purple);">
                        </div>
                        <div style="margin-bottom: 0.5rem;">
                            <label style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.25rem;">
                                <span style="font-size: 0.9rem;">Samples <strong style="color: var(--accent-cyan);">n</strong></span>
                                <code id="n-value" style="color: var(--accent-cyan);">1320</code>
                            </label>
                            <input type="range" id="n-slider" min="10" max="1320" step="10" value="1320"
                                   style="width: 100%; accent-color: var(--accent-cyan);">
                        </div>
                        <div style="text-align: center; padding: 0.5rem; background: rgba(163, 113, 247, 0.15); border-radius: 6px;">
                            <div style="font-size: 0.75rem; color: var(--text-secondary);">Standard Deviation œÉ</div>
                            <div id="std-result" style="font-size: 1.5rem; font-weight: 700; color: var(--accent-green); font-family: 'JetBrains Mono';">0.98%</div>
                            <div id="trust-level" style="font-size: 0.8rem; color: var(--accent-green);">HIGH trust</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 16: Beta Smoothing  -->
        <!-- ========================= -->
        <section class="slide" data-slide="16">
            <h2 class="fade-in fade-in-delay-1">Beta Smoothing</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Why Smoothing?</h3>
                    <p style="margin-bottom: 1rem;">
                        Raw accuracy estimates are noisy, especially with few samples. Beta smoothing stabilizes estimates.
                    </p>

                    <div class="math-block">
                        $$\hat{p}_{\text{smooth}} = \frac{k + \alpha}{n + \alpha + \beta}$$
                    </div>
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                        <strong>k</strong> = successes, <strong>n</strong> = trials, <strong>Œ±,Œ≤</strong> = prior pseudo-counts
                    </p>

                    <div class="highlight-box highlight-purple" style="margin-top: 1rem;">
                        <strong>Effect:</strong> Shrinks extreme estimates (0% or 100%) toward the prior mean
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Empirical Bayes Prior</h3>
                    <p style="margin-bottom: 1rem; font-size: 0.9rem;">
                        Prior Œ±, Œ≤ fitted from observed data via Method of Moments:
                    </p>

                    <div class="card" style="padding: 0.8rem; margin-bottom: 0.8rem;">
                        <div class="math-block" style="font-size: 0.95rem;">
                            $$\text{common} = \frac{\mu(1-\mu)}{\sigma^2} - 1$$
                        </div>
                        <div class="math-block" style="font-size: 0.95rem; margin-top: 0.3rem;">
                            $$\alpha = \mu \cdot \text{common}, \quad \beta = (1-\mu) \cdot \text{common}$$
                        </div>
                    </div>

                    <div class="highlight-box highlight-cyan">
                        <strong>Benefit:</strong> Prior centered at data mean (~15%), not naive 50%. Better calibration for rare events.
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 17: UCB Acquisition -->
        <!-- ========================= -->
        <section class="slide" data-slide="17">
            <h2 class="fade-in fade-in-delay-1">UCB: Upper Confidence Bound</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Acquisition Function</h3>
                    <p style="margin-bottom: 1.5rem;">
                        UCB balances exploitation (high predicted value) with exploration (high uncertainty).
                    </p>

                    <div class="math-block">
                        $$\text{UCB}(\mathbf{z}) = \mu(\mathbf{z}) + \beta \cdot \sigma(\mathbf{z})$$
                    </div>
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                        <strong>Œº(z)</strong> = GP posterior mean, <strong>œÉ(z)</strong> = GP posterior std, <strong>Œ≤</strong> = exploration weight
                    </p>

                    <div class="highlight-box highlight-cyan" style="margin-top: 1rem; padding: 0.75rem;">
                        <strong>Adaptive Œ≤ Scheduling</strong>
                        <p style="margin-top: 0.3rem; font-size: 0.95rem;">
                            Œ≤ decays from 8.0 ‚Üí 2.0 over iterations. Early: more exploration. Late: more exploitation.
                        </p>
                    </div>

                    <div class="card" style="margin-top: 0.75rem; padding: 0.75rem;">
                        <h4 style="color: var(--accent-purple); margin-bottom: 0.3rem; font-size: 0.9rem;">Why UCB over EI?</h4>
                        <p style="font-size: 0.85rem;">
                            ‚Ä¢ Simpler formulation, easier to tune<br>
                            ‚Ä¢ Direct control over exploration via Œ≤<br>
                            ‚Ä¢ No numerical stability issues
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Optimization Parameters</h3>
                    <table>
                        <tr>
                            <td><code>Œ≤_start</code></td>
                            <td style="color: var(--accent-orange);">8.0</td>
                            <td>Initial exploration</td>
                        </tr>
                        <tr>
                            <td><code>Œ≤_final</code></td>
                            <td style="color: var(--accent-purple);">2.0</td>
                            <td>Final exploitation</td>
                        </tr>
                        <tr>
                            <td><code>noise_scale</code></td>
                            <td style="color: var(--accent-green);">0.05</td>
                            <td>Latent perturbation</td>
                        </tr>
                        <tr>
                            <td><code>num_restarts</code></td>
                            <td style="color: var(--accent-cyan);">64</td>
                            <td>L-BFGS-B multi-starts</td>
                        </tr>
                    </table>

                    <div class="diagram-container" style="height: 250px; margin-top: 1.5rem;">
                        <svg viewBox="0 0 400 220" xmlns="http://www.w3.org/2000/svg">
                            <!-- Axes -->
                            <line x1="40" y1="180" x2="380" y2="180" stroke="#6e7681" stroke-width="2"/>
                            <line x1="40" y1="180" x2="40" y2="20" stroke="#6e7681" stroke-width="2"/>

                            <text x="210" y="210" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">z (latent space)</text>
                            <text x="15" y="100" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit" transform="rotate(-90, 15, 100)">value</text>

                            <!-- GP mean -->
                            <path d="M 40 140 Q 100 120 150 100 Q 200 90 250 95 Q 300 105 360 130" fill="none" stroke="#58a6ff" stroke-width="2"/>
                            <text x="370" y="125" fill="#58a6ff" font-size="10" font-family="Outfit">Œº</text>

                            <!-- Uncertainty band -->
                            <path d="M 40 100 Q 100 70 150 55 Q 200 45 250 50 Q 300 60 360 85" fill="none" stroke="#a371f7" stroke-width="1" stroke-dasharray="4"/>
                            <path d="M 40 180 Q 100 170 150 145 Q 200 135 250 140 Q 300 150 360 175" fill="none" stroke="#a371f7" stroke-width="1" stroke-dasharray="4"/>

                            <!-- UCB line -->
                            <path d="M 40 80 Q 100 45 150 30 Q 200 20 250 25 Q 300 35 360 60" fill="none" stroke="#d29922" stroke-width="3"/>
                            <text x="370" y="55" fill="#d29922" font-size="10" font-family="Outfit">UCB</text>

                            <!-- Optimal point -->
                            <circle cx="200" cy="20" r="6" fill="#3fb950"/>
                            <text x="200" y="10" text-anchor="middle" fill="#3fb950" font-size="10" font-family="Outfit">z*</text>

                            <!-- Legend -->
                            <rect x="280" y="140" width="100" height="35" rx="4" fill="rgba(22,27,34,0.9)" stroke="#6e7681"/>
                            <line x1="290" y1="152" x2="310" y2="152" stroke="#d29922" stroke-width="2"/>
                            <text x="315" y="156" fill="#8b949e" font-size="9" font-family="Outfit">Œº + Œ≤¬∑œÉ</text>
                            <line x1="290" y1="167" x2="310" y2="167" stroke="#a371f7" stroke-width="1" stroke-dasharray="4"/>
                            <text x="315" y="171" fill="#8b949e" font-size="9" font-family="Outfit">¬±œÉ band</text>
                        </svg>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 23: Candidate Rejection -->
        <!-- ========================= -->
        <section class="slide" data-slide="23">
            <h2 class="fade-in fade-in-delay-1">Candidate Rejection Loop <span style="font-size: 0.6em; color: var(--accent-orange);">(Sampling)</span></h2>

            <div class="content-split" style="gap: 1.5rem;">
                <!-- Left column: U-shaped diagram (bigger) -->
                <div class="fade-in fade-in-delay-2" style="flex: 1.4;">
                    <svg viewBox="0 0 560 380" style="width: 100%;" xmlns="http://www.w3.org/2000/svg">
                        <!-- ROW 1: 32D level -->
                        <text x="80" y="22" text-anchor="middle" fill="#8b949e" font-size="13" font-family="Outfit">32D</text>
                        <rect x="15" y="32" width="130" height="55" rx="8" fill="rgba(163,113,247,0.2)" stroke="#a371f7" stroke-width="2"/>
                        <text x="80" y="66" text-anchor="middle" fill="#a371f7" font-size="16" font-weight="600" font-family="Outfit">z* (32D)</text>

                        <!-- Arrow down from z* -->
                        <line x1="80" y1="87" x2="80" y2="115" stroke="#a371f7" stroke-width="2"/>
                        <polygon points="80,122 75,112 85,112" fill="#a371f7"/>

                        <!-- VAE Decoder -->
                        <rect x="15" y="125" width="130" height="50" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                        <text x="80" y="156" text-anchor="middle" fill="#00d9ff" font-size="14" font-weight="500" font-family="Outfit">VAE Decoder</text>

                        <!-- Arrow down -->
                        <line x1="80" y1="175" x2="80" y2="203" stroke="#00d9ff" stroke-width="2"/>
                        <polygon points="80,210 75,200 85,200" fill="#00d9ff"/>

                        <!-- ROW 2: 768D level - LEFT xÃÇ -->
                        <text x="80" y="208" text-anchor="middle" fill="#8b949e" font-size="13" font-family="Outfit">768D</text>
                        <rect x="15" y="218" width="130" height="55" rx="8" fill="rgba(210,153,34,0.3)" stroke="#d29922" stroke-width="2"/>
                        <text x="80" y="252" text-anchor="middle" fill="#d29922" font-size="16" font-weight="600" font-family="JetBrains Mono">xÃÇ (768D)</text>

                        <!-- Arrow down to Vec2Text -->
                        <line x1="80" y1="273" x2="80" y2="305" stroke="#d29922" stroke-width="2"/>
                        <polygon points="80,312 75,302 85,302" fill="#d29922"/>

                        <!-- ROW 3: Text level - BOTTOM OF U -->
                        <rect x="15" y="315" width="130" height="50" rx="8" fill="rgba(247,120,186,0.2)" stroke="#f778ba" stroke-width="2"/>
                        <text x="80" y="346" text-anchor="middle" fill="#f778ba" font-size="14" font-weight="500" font-family="Outfit">Vec2Text</text>

                        <!-- Arrow right -->
                        <line x1="145" y1="340" x2="178" y2="340" stroke="#f778ba" stroke-width="2"/>
                        <polygon points="185,340 175,335 175,345" fill="#f778ba"/>

                        <!-- Generated text (center bottom) -->
                        <rect x="190" y="315" width="140" height="50" rx="8" fill="rgba(139,148,158,0.2)" stroke="#8b949e" stroke-width="2"/>
                        <text x="260" y="346" text-anchor="middle" fill="#e6edf3" font-size="13" font-family="Outfit">"instruction"</text>

                        <!-- Arrow right -->
                        <line x1="330" y1="340" x2="363" y2="340" stroke="#8b949e" stroke-width="2"/>
                        <polygon points="370,340 360,335 360,345" fill="#8b949e"/>

                        <!-- GTR Encoder -->
                        <rect x="375" y="315" width="130" height="50" rx="8" fill="rgba(63,185,80,0.2)" stroke="#3fb950" stroke-width="2"/>
                        <text x="440" y="346" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="500" font-family="Outfit">GTR Encoder</text>

                        <!-- Arrow up -->
                        <line x1="440" y1="315" x2="440" y2="280" stroke="#3fb950" stroke-width="2"/>
                        <polygon points="440,273 435,283 445,283" fill="#3fb950"/>

                        <!-- ROW 2: 768D level - RIGHT x' (same level as xÃÇ) -->
                        <text x="440" y="208" text-anchor="middle" fill="#8b949e" font-size="13" font-family="Outfit">768D</text>
                        <rect x="375" y="218" width="130" height="55" rx="8" fill="rgba(63,185,80,0.3)" stroke="#3fb950" stroke-width="2"/>
                        <text x="440" y="252" text-anchor="middle" fill="#3fb950" font-size="16" font-weight="600" font-family="JetBrains Mono">x' (768D)</text>

                        <!-- COSINE CHECK in center with Accept/Reject -->
                        <rect x="175" y="55" width="210" height="130" rx="10" fill="rgba(63,185,80,0.1)" stroke="#3fb950" stroke-width="2"/>
                        <text x="280" y="85" text-anchor="middle" fill="#3fb950" font-size="15" font-weight="600" font-family="Outfit">Cosine Check</text>
                        <text x="280" y="115" text-anchor="middle" fill="#e6edf3" font-size="17" font-weight="600" font-family="JetBrains Mono">cos(xÃÇ, x') ‚â• 0.90</text>

                        <!-- Accept/Reject inside cosine block -->
                        <rect x="195" y="135" width="75" height="35" rx="6" fill="rgba(63,185,80,0.4)" stroke="#3fb950" stroke-width="1.5"/>
                        <text x="232" y="158" text-anchor="middle" fill="#3fb950" font-size="13" font-weight="600" font-family="Outfit">‚úì Accept</text>

                        <rect x="290" y="135" width="75" height="35" rx="6" fill="rgba(248,81,73,0.3)" stroke="#f85149" stroke-width="1.5"/>
                        <text x="327" y="158" text-anchor="middle" fill="#f85149" font-size="13" font-weight="600" font-family="Outfit">‚úó Retry</text>

                        <!-- Dashed lines from embeddings to cosine check -->
                        <path d="M 145 245 Q 165 245 175 180" fill="none" stroke="#d29922" stroke-width="2" stroke-dasharray="6,4"/>
                        <path d="M 375 245 Q 355 245 350 185" fill="none" stroke="#3fb950" stroke-width="2" stroke-dasharray="6,4"/>
                    </svg>
                </div>

                <!-- Right column: Info cards stacked vertically -->
                <div class="fade-in fade-in-delay-3" style="flex: 0.6; display: flex; flex-direction: column; gap: 0.8rem;">
                    <div class="card" style="padding: 1rem;">
                        <h4 style="color: var(--accent-green); margin-bottom: 0.4rem; font-size: 1rem;">Parameters</h4>
                        <div style="font-size: 0.9rem;">
                            <code>cosine_threshold</code> = <span style="color: var(--accent-green);">0.90</span><br>
                            <code>max_attempts</code> = <span style="color: var(--accent-orange);">10</span>
                        </div>
                    </div>

                    <div class="card" style="padding: 1rem;">
                        <h4 style="color: var(--accent-orange); margin-bottom: 0.4rem; font-size: 1rem;">Why check?</h4>
                        <p style="font-size: 0.85rem; color: var(--text-secondary);">
                            Vec2Text sampling is stochastic. Low similarity ‚Üí discard sample, try again with new random seed.
                        </p>
                    </div>

                    <div class="card" style="padding: 1rem;">
                        <h4 style="color: var(--accent-red); margin-bottom: 0.4rem; font-size: 1rem;">Fallback</h4>
                        <p style="font-size: 0.85rem; color: var(--text-secondary);">
                            After 10 resampling attempts, accept candidate with highest cosine similarity.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 27: Quality KPIs    -->
        <!-- ========================= -->
        <section class="slide" data-slide="27">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">Quality KPIs Overview</h2>

            <div class="content-full" style="justify-content: center;">
                <div class="two-col" style="margin-bottom: 2rem;">
                    <div class="fade-in fade-in-delay-2">
                        <div class="card" style="border-left: 3px solid var(--accent-purple);">
                            <h3 style="color: var(--accent-purple);">Q<sub>VAE</sub>: VAE Quality</h3>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                Reconstruction quality with percentile analysis
                            </p>
                            <div style="margin-top: 1rem;">
                                <strong>Target:</strong> Q<sub>10</sub> &gt; 0.90
                            </div>
                        </div>
                    </div>

                    <div class="fade-in fade-in-delay-3">
                        <div class="card" style="border-left: 3px solid var(--accent-green);">
                            <h3 style="color: var(--accent-green);">Q<sub>GP</sub>: GP Predictive Power</h3>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                Spearman rank correlation: predicted vs actual
                            </p>
                            <div style="margin-top: 1rem;">
                                <strong>Target:</strong> œÅ &gt; 0.4
                            </div>
                        </div>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-4" style="max-width: 600px; margin: 0 auto;">
                    <div class="card" style="border-left: 3px solid var(--accent-orange);">
                        <h3 style="color: var(--accent-orange);">Q<sub>Sys</sub>: System Gap</h3>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Optimization gap between z_opt and z_real (after text generation)
                        </p>
                        <div style="margin-top: 1rem;">
                            <strong>Target:</strong> mean &lt; 0.5, max &lt; 1.0
                        </div>
                    </div>
                </div>

                <div class="highlight-box highlight-cyan fade-in fade-in-delay-5" style="margin-top: 2rem; text-align: center;">
                    <strong>All three metrics must be healthy for effective optimization</strong>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 28: VAE Quality     -->
        <!-- ========================= -->
        <section class="slide" data-slide="28">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">VAE Quality (Q<sub>VAE</sub>)</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Percentile Analysis</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Round-trip reconstruction: text ‚Üí GTR ‚Üí VAE ‚Üí cosine similarity
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Good</th>
                                <th>Acceptable</th>
                                <th>Poor</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Q<sub>10</sub></td>
                                <td style="color: var(--accent-green);">&gt; 0.92</td>
                                <td style="color: var(--accent-orange);">&gt; 0.90</td>
                                <td style="color: var(--accent-red);">‚â§ 0.90</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="highlight-box highlight-purple" style="margin-top: 1.5rem;">
                        <strong>Why Q<sub>10</sub>?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            10th percentile catches worst-case reconstructions. Mean alone hides outliers.
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>What it Catches</h3>
                    <ul class="feature-list">
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-red);">‚ö†Ô∏è</div>
                            <div>
                                <strong>Posterior collapse</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">All z map to same point</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-orange);">üï≥Ô∏è</div>
                            <div>
                                <strong>Latent space holes</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Some regions poorly decoded</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üìâ</div>
                            <div>
                                <strong>Mode dropping</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Styles poorly represented</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 29: GP Quality      -->
        <!-- ========================= -->
        <section class="slide" data-slide="29">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">GP Predictive Power (Q<sub>GP</sub>)</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Spearman Rank Correlation</h3>
                    <div class="math-block">
                        $$\rho = 1 - \frac{6 \sum d_i^2}{n(n^2-1)}$$
                    </div>
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.5rem;">
                        <strong>œÅ</strong> = correlation coefficient, <strong>d<sub>i</sub></strong> = rank difference for sample i, <strong>n</strong> = number of samples
                    </p>

                    <p style="margin-top: 0.75rem;">
                        Measures rank-order consistency between GP predictions and actual errors during inference.
                    </p>

                    <table style="margin-top: 1.5rem;">
                        <thead>
                            <tr>
                                <th>œÅ</th>
                                <th>Quality</th>
                                <th>Interpretation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="color: var(--accent-green);">&gt; 0.4</td>
                                <td>Good</td>
                                <td>Meaningful guidance</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-orange);">&gt; 0.2</td>
                                <td>Poor</td>
                                <td>Some signal</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-red);">‚â§ 0.2</td>
                                <td>Random</td>
                                <td>No predictive value</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">

                    <div class="highlight-box highlight-green" style="margin-top: 1.5rem;">
                        <strong>Why rank correlation?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            We need GP to correctly rank prompts, not predict exact values. EI only needs relative ordering.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 30: System Gap      -->
        <!-- ========================= -->
        <section class="slide" data-slide="30">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">System Gap (Q<sub>Sys</sub>)</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Optimization Gap</h3>
                    <p style="margin-bottom: 0.75rem; font-size: 0.95rem;">
                        Measures distance between intended latent z_opt and realized z_real (after text generation).
                    </p>

                    <div class="math-block" style="padding: 0.75rem; margin: 0.5rem 0;">
                        $$\text{gap} = \| z_{\text{opt}} - z_{\text{real}} \|_2$$
                    </div>
                    <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.3rem;">
                        <strong>z<sub>opt</sub></strong> = optimized latent from BO, <strong>z<sub>real</sub></strong> = actual latent after text generation, <strong>‚Äñ¬∑‚Äñ<sub>2</sub></strong> = L2 norm
                    </p>

                    <p style="margin-top: 0.5rem; font-size: 0.9rem;">
                        z<sub>real</sub> = VAE.encode(GTR(generated_text))
                    </p>

                    <table style="margin-top: 0.75rem; font-size: 0.9rem;">
                        <thead>
                            <tr>
                                <th>Mean Gap</th>
                                <th>Quality</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="color: var(--accent-green);">&lt; 0.5</td>
                                <td>Good</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-orange);">&lt; 1.0</td>
                                <td>Acceptable</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-red);">‚â• 1.0</td>
                                <td>Poor</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 280px;">
                        <svg viewBox="0 0 400 250" xmlns="http://www.w3.org/2000/svg">
                            <!-- Latent space visualization -->
                            <ellipse cx="200" cy="125" rx="180" ry="100" fill="none" stroke="#6e7681" stroke-width="1" stroke-dasharray="4,4"/>
                            <text x="200" y="235" text-anchor="middle" fill="#6e7681" font-size="11" font-family="Outfit">32D Latent Space</text>

                            <!-- z_opt -->
                            <circle cx="150" cy="100" r="10" fill="#d29922"/>
                            <text x="150" y="75" text-anchor="middle" fill="#d29922" font-size="11" font-family="Outfit">z_opt</text>
                            <text x="150" y="130" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">(optimized)</text>

                            <!-- z_real -->
                            <circle cx="250" cy="140" r="10" fill="#3fb950"/>
                            <text x="250" y="115" text-anchor="middle" fill="#3fb950" font-size="11" font-family="Outfit">z_real</text>
                            <text x="250" y="170" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">(realized)</text>

                            <!-- Gap line -->
                            <line x1="160" y1="100" x2="240" y2="140" stroke="#f85149" stroke-width="2" stroke-dasharray="6,3"/>
                            <text x="200" y="108" text-anchor="middle" fill="#f85149" font-size="10" font-family="Outfit">gap</text>

                            <!-- Process arrow -->
                            <path d="M 160 105 Q 200 160 240 135" fill="none" stroke="#a371f7" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="230" y="185" text-anchor="middle" fill="#a371f7" font-size="9" font-family="Outfit">decode ‚Üí Vec2Text ‚Üí GTR ‚Üí encode</text>
                        </svg>
                    </div>

                    <div class="highlight-box highlight-orange" style="margin-top: 1rem;">
                        <strong>Large gap indicates:</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Vec2Text distortion or VAE decoder issues. Optimization is searching wrong regions.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE: Results            -->
        <!-- ========================= -->
        <section class="slide" data-slide="results">
            <span class="section-badge fade-in">Evaluation</span>
            <h2 class="fade-in fade-in-delay-1">Results: LIPO vs OPRO</h2>

            <div class="content-split" style="gap: 2rem;">
                <!-- Left: Comparison Table -->
                <div class="fade-in fade-in-delay-2">
                    <h3 style="margin-bottom: 1rem;">Performance Comparison</h3>
                    <table style="width: 100%; font-size: 0.9rem;">
                        <thead>
                            <tr>
                                <th style="text-align: left;">Metric</th>
                                <th style="text-align: center; color: var(--accent-cyan);">LIPO</th>
                                <th style="text-align: center; color: var(--accent-orange);">OPRO</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Test Accuracy</td>
                                <td style="text-align: center; color: var(--accent-green); font-weight: 700;">90.45%</td>
                                <td style="text-align: center;">84.84%</td>
                            </tr>
                            <tr>
                                <td>Test Error Rate</td>
                                <td style="text-align: center; color: var(--accent-green); font-weight: 700;">9.55%</td>
                                <td style="text-align: center;">15.16%</td>
                            </tr>
                            <tr>
                                <td>Correct / Total</td>
                                <td style="text-align: center;">1193 / 1319</td>
                                <td style="text-align: center;">1119 / 1319</td>
                            </tr>
                            <tr>
                                <td>LLM Calls</td>
                                <td style="text-align: center; color: var(--accent-green); font-weight: 700;">111,350</td>
                                <td style="text-align: center;">132,327</td>
                            </tr>
                            <tr>
                                <td>Iterations</td>
                                <td style="text-align: center;">50</td>
                                <td style="text-align: center;">64</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="highlight-box highlight-green" style="margin-top: 1rem; padding: 0.8rem;">
                        <strong>LIPO Improvement:</strong> +5.61 pp accuracy, 16% fewer LLM calls
                    </div>
                </div>

                <!-- Right: Best Prompts & Config -->
                <div class="fade-in fade-in-delay-3">
                    <h3 style="margin-bottom: 0.8rem;">Best Optimized Prompts</h3>

                    <div class="card" style="padding: 0.8rem; margin-bottom: 0.8rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 0.4rem; font-size: 0.85rem;">LIPO Best Instruction</h4>
                        <p style="font-size: 0.85rem; font-style: italic; color: var(--text-secondary);">
                            "Organise and Calculate step by step. Calculate the total in each step. Subsequently, give the values (a, )."
                        </p>
                    </div>

                    <div class="card" style="padding: 0.8rem; margin-bottom: 1rem;">
                        <h4 style="color: var(--accent-orange); margin-bottom: 0.4rem; font-size: 0.85rem;">OPRO Best Instruction</h4>
                        <p style="font-size: 0.85rem; font-style: italic; color: var(--text-secondary);">
                            "ÊñáÊú¨ÔºöËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÊñπÊ≥ïÊòØ‰ªÄ‰πàÔºü"
                        </p>
                    </div>

                    <h3 style="margin-bottom: 0.6rem;">LIPO Quality KPIs</h3>
                    <table style="font-size: 0.8rem;">
                        <tr>
                            <td>Q<sub>GP</sub> (Spearman œÅ)</td>
                            <td style="color: var(--accent-green);">0.41</td>
                        </tr>
                        <tr>
                            <td>Q<sub>VAE</sub> (cosine mean)</td>
                            <td style="color: var(--accent-cyan);">92.3%</td>
                        </tr>
                        <tr>
                            <td>Q<sub>Sys</sub> (gap mean)</td>
                            <td style="color: var(--accent-orange);">0.74</td>
                        </tr>
                    </table>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE: Future Work        -->
        <!-- ========================= -->
        <section class="slide" data-slide="future">
            <span class="section-badge fade-in">Outlook</span>
            <h2 class="fade-in fade-in-delay-1">Future Work</h2>

            <div class="fade-in fade-in-delay-2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
                <!-- Vec2Text Improvements -->
                <div class="card" style="padding: 1.2rem;">
                    <h3 style="color: var(--accent-cyan); margin-bottom: 0.8rem; font-size: 1.1rem;">
                        <span style="margin-right: 0.5rem;">üîÑ</span>Vec2Text Alternatives
                    </h3>
                    <p style="font-size: 0.95rem; color: var(--text-secondary);">
                        Replace current Vec2Text with <strong>pretrained Vec2Text</strong> or <strong>pretrained LLM projection</strong> for better text reconstruction quality.
                    </p>
                </div>

                <!-- Exemplars -->
                <div class="card" style="padding: 1.2rem;">
                    <h3 style="color: var(--accent-purple); margin-bottom: 0.8rem; font-size: 1.1rem;">
                        <span style="margin-right: 0.5rem;">üìö</span>Extend to Exemplars
                    </h3>
                    <p style="font-size: 0.95rem; color: var(--text-secondary);">
                        Optimize not just instructions but also <strong>few-shot examples</strong> in the prompt for improved in-context learning.
                    </p>
                </div>

                <!-- Datasets -->
                <div class="card" style="padding: 1.2rem;">
                    <h3 style="color: var(--accent-orange); margin-bottom: 0.8rem; font-size: 1.1rem;">
                        <span style="margin-right: 0.5rem;">üìä</span>Dataset Evaluation
                    </h3>
                    <p style="font-size: 0.95rem; color: var(--text-secondary);">
                        Test on diverse benchmarks: <strong>Claudette</strong>, <strong>BBH</strong> (BIG-Bench Hard), and other challenging reasoning tasks.
                    </p>
                </div>

                <!-- Baseline Comparisons -->
                <div class="card" style="padding: 1.2rem;">
                    <h3 style="color: var(--accent-green); margin-bottom: 0.8rem; font-size: 1.1rem;">
                        <span style="margin-right: 0.5rem;">‚öîÔ∏è</span>Baseline Comparisons
                    </h3>
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">
                        Compare against state-of-the-art methods:
                    </p>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.4rem; margin-top: 0.5rem;">
                        <span class="dim-badge" style="font-size: 0.75rem;">APE</span>
                        <span class="dim-badge" style="font-size: 0.75rem; border-color: var(--accent-purple); color: var(--accent-purple);">PromptBreeder</span>
                        <span class="dim-badge" style="font-size: 0.75rem; border-color: var(--accent-cyan); color: var(--accent-cyan);">ProTeGi</span>
                        <span class="dim-badge" style="font-size: 0.75rem; border-color: var(--accent-orange); color: var(--accent-orange);">GEPA</span>
                        <span class="dim-badge" style="font-size: 0.75rem; border-color: var(--accent-green); color: var(--accent-green);">SAMMO</span>
                        <span class="dim-badge" style="font-size: 0.75rem; border-color: var(--accent-magenta); color: var(--accent-magenta);">MIPROv2</span>
                        <span class="dim-badge" style="font-size: 0.75rem; border-color: var(--accent-red); color: var(--accent-red);">TextGrad</span>
                        <span class="dim-badge" style="font-size: 0.75rem;">BootstrapFewShot</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 33: Conclusion      -->
        <!-- ========================= -->
        <section class="slide slide-center" data-slide="33">
            <div class="fade-in">
                <h1 style="background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 50%, var(--accent-magenta) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 3.5rem;">
                    LIPO
                </h1>
                <p class="fade-in fade-in-delay-1" style="font-size: 1.5rem; color: var(--text-secondary); margin-top: 1rem;">
                    Latent Instruction Prompt Optimization
                </p>
            </div>

            <div class="fade-in fade-in-delay-2" style="margin-top: 3rem;">
                <div class="highlight-box highlight-purple" style="max-width: 700px; text-align: center;">
                    <p style="font-size: 1.2rem; color: var(--text-primary);">
                        Efficient prompt optimization through<br>
                        <strong style="color: var(--accent-cyan);">VAE compression</strong> +
                        <strong style="color: var(--accent-purple);">Bayesian optimization</strong> +
                        <strong style="color: var(--accent-green);">Text inversion</strong>
                    </p>
                </div>
            </div>

            <div class="fade-in fade-in-delay-3" style="margin-top: 3rem;">
                <span class="dim-badge">768D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-orange); color: var(--accent-orange);">Optimize</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-green); color: var(--accent-green);">Text</span>
            </div>

            <p class="fade-in fade-in-delay-4" style="margin-top: 3rem; font-size: 1.1rem; color: var(--text-muted);">
                Thank you!
            </p>
        </section>

    </div>

    <!-- Progress bar -->
    <div class="progress-bar" id="progressBar"></div>

    <!-- Slide counter -->
    <div class="slide-counter">
        <span id="currentSlide">1</span> / <span id="totalSlides">22</span>
    </div>


    <script>
        // Presentation logic
        const slides = document.querySelectorAll('.slide');
        const totalSlides = 22;
        let currentSlide = 0;

        document.getElementById('totalSlides').textContent = totalSlides;

        function updateSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                if (i === index) {
                    slide.classList.add('active');
                }
            });

            currentSlide = index;
            document.getElementById('currentSlide').textContent = index + 1;
            document.getElementById('progressBar').style.width =
                ((index + 1) / totalSlides * 100) + '%';
        }

        function nextSlide() {
            if (currentSlide < slides.length - 1) {
                updateSlide(currentSlide + 1);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                updateSlide(currentSlide - 1);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                prevSlide();
            }
        });

        // Touch support
        let touchStartX = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        });

        document.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > 50) {
                if (diff > 0) nextSlide();
                else prevSlide();
            }
        });

        // Initialize KaTeX
        document.addEventListener('DOMContentLoaded', function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });

            // Variance Calculator
            const pSlider = document.getElementById('p-slider');
            const nSlider = document.getElementById('n-slider');
            const pValue = document.getElementById('p-value');
            const nValue = document.getElementById('n-value');
            const stdResult = document.getElementById('std-result');
            const trustLevel = document.getElementById('trust-level');

            // Empirical Bayes prior parameters (fitted from data with mean ‚âà 0.15)
            const ALPHA = 2;
            const BETA = 11;

            function updateVariance() {
                const p = parseFloat(pSlider.value);
                const n = parseInt(nSlider.value);
                // Beta Posterior Variance: p(1-p) / (n + Œ± + Œ≤ + 1)
                const variance = (p * (1 - p)) / (n + ALPHA + BETA + 1);
                const std = Math.sqrt(variance);

                pValue.textContent = p.toFixed(2);
                nValue.textContent = n;
                const stdPercent = std * 100;
                stdResult.textContent = stdPercent.toFixed(2) + '%';

                // Update trust level based on std
                if (stdPercent > 10) {
                    trustLevel.textContent = 'LOW trust';
                    trustLevel.style.color = 'var(--accent-red)';
                    stdResult.style.color = 'var(--accent-red)';
                } else if (stdPercent > 2) {
                    trustLevel.textContent = 'Medium trust';
                    trustLevel.style.color = 'var(--accent-orange)';
                    stdResult.style.color = 'var(--accent-orange)';
                } else {
                    trustLevel.textContent = 'HIGH trust';
                    trustLevel.style.color = 'var(--accent-green)';
                    stdResult.style.color = 'var(--accent-green)';
                }
            }

            pSlider.addEventListener('input', updateVariance);
            nSlider.addEventListener('input', updateVariance);
            updateVariance();
        });
    </script>
</body>
</html>
