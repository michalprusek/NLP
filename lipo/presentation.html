<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIPO: Latent Instruction Prompt Optimization</title>

    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Dark theme palette */
            --bg-deep: #0a0e14;
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #1c2128;
            --bg-card: #21262d;

            /* Text colors */
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;

            /* Accent colors - pipeline stages */
            --accent-cyan: #00d9ff;      /* Encoding */
            --accent-blue: #58a6ff;      /* Processing */
            --accent-purple: #a371f7;    /* Latent space */
            --accent-magenta: #f778ba;   /* Optimization */
            --accent-green: #3fb950;     /* Success/Output */
            --accent-orange: #d29922;    /* Warning/Attention */
            --accent-red: #f85149;       /* Error/Important */

            /* Gradients */
            --gradient-cyan: linear-gradient(135deg, #00d9ff 0%, #0099cc 100%);
            --gradient-purple: linear-gradient(135deg, #a371f7 0%, #8957e5 100%);
            --gradient-green: linear-gradient(135deg, #3fb950 0%, #238636 100%);
            --gradient-orange: linear-gradient(135deg, #d29922 0%, #bb8009 100%);

            /* Typography */
            --font-display: 'Outfit', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;

            /* Spacing */
            --slide-padding: 60px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--bg-deep);
            font-family: var(--font-display);
            color: var(--text-primary);
        }

        /* Presentation container */
        .presentation {
            width: 100%;
            height: 100%;
            position: relative;
        }

        /* Individual slides */
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: var(--slide-padding);
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            background: var(--bg-primary);
            overflow: hidden;
        }

        .slide.active {
            opacity: 1;
            visibility: visible;
        }

        /* Blueprint grid background */
        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                linear-gradient(rgba(0, 217, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 217, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 0;
        }

        .slide > * {
            position: relative;
            z-index: 1;
        }

        /* Typography */
        h1 {
            font-size: 3.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1.1;
            margin-bottom: 1rem;
        }

        h2 {
            font-size: 2.5rem;
            font-weight: 600;
            letter-spacing: -0.01em;
            margin-bottom: 1.5rem;
            color: var(--accent-cyan);
        }

        h3 {
            font-size: 1.5rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        p {
            font-size: 1.25rem;
            line-height: 1.6;
            color: var(--text-secondary);
            max-width: 900px;
        }

        .mono {
            font-family: var(--font-mono);
        }

        /* Slide layouts */
        .slide-center {
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .slide-title {
            background: radial-gradient(ellipse at center, var(--bg-secondary) 0%, var(--bg-deep) 100%);
        }

        .slide-title h1 {
            font-size: 4rem;
            background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 50%, var(--accent-magenta) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.5rem;
        }

        .slide-title .subtitle {
            font-size: 1.5rem;
            color: var(--text-secondary);
            font-weight: 300;
            margin-bottom: 3rem;
        }

        .slide-title .authors {
            font-size: 1.1rem;
            color: var(--text-muted);
        }

        /* Content layouts */
        .content-split {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            flex: 1;
            align-items: center;
        }

        .content-full {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Cards and boxes */
        .card {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .card-glow {
            box-shadow: 0 0 30px rgba(0, 217, 255, 0.1);
        }

        /* Lists */
        ul, ol {
            font-size: 1.2rem;
            line-height: 1.8;
            color: var(--text-secondary);
            padding-left: 1.5rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        li::marker {
            color: var(--accent-cyan);
        }

        /* Code blocks */
        .code-block {
            background: var(--bg-deep);
            border: 1px solid var(--bg-tertiary);
            border-radius: 8px;
            padding: 1.25rem;
            font-family: var(--font-mono);
            font-size: 0.95rem;
            line-height: 1.6;
            overflow-x: auto;
        }

        .code-block .keyword { color: var(--accent-purple); }
        .code-block .function { color: var(--accent-cyan); }
        .code-block .string { color: var(--accent-green); }
        .code-block .number { color: var(--accent-orange); }
        .code-block .comment { color: var(--text-muted); font-style: italic; }

        /* Math display */
        .math-block {
            background: var(--bg-secondary);
            border-left: 3px solid var(--accent-purple);
            padding: 1.5rem 2rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
            font-size: 1.3rem;
        }

        /* Dimension badges */
        .dim-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-cyan);
            border-radius: 20px;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--accent-cyan);
            margin: 0 0.25rem;
        }

        /* Highlight boxes */
        .highlight-box {
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
        }

        .highlight-cyan {
            background: rgba(0, 217, 255, 0.1);
            border: 1px solid rgba(0, 217, 255, 0.3);
        }

        .highlight-purple {
            background: rgba(163, 113, 247, 0.1);
            border: 1px solid rgba(163, 113, 247, 0.3);
        }

        .highlight-green {
            background: rgba(63, 185, 80, 0.1);
            border: 1px solid rgba(63, 185, 80, 0.3);
        }

        .highlight-orange {
            background: rgba(210, 153, 34, 0.1);
            border: 1px solid rgba(210, 153, 34, 0.3);
        }

        /* Progress bar */
        .progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            height: 3px;
            background: var(--gradient-cyan);
            transition: width 0.3s ease;
            z-index: 1000;
        }

        /* Slide counter */
        .slide-counter {
            position: fixed;
            bottom: 20px;
            right: 30px;
            font-family: var(--font-mono);
            font-size: 0.9rem;
            color: var(--text-muted);
            z-index: 1000;
        }

        /* Navigation hints */
        .nav-hint {
            position: fixed;
            bottom: 20px;
            left: 30px;
            font-size: 0.85rem;
            color: var(--text-muted);
            z-index: 1000;
        }

        .nav-hint kbd {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--bg-card);
            border-radius: 4px;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            margin: 0 0.2rem;
        }

        /* ===================== */
        /* SVG DIAGRAM STYLES    */
        /* ===================== */

        .diagram-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .diagram-container svg {
            max-width: 100%;
            max-height: 100%;
        }

        /* SVG styling */
        .svg-node {
            transition: all 0.3s ease;
        }

        .svg-node:hover {
            filter: brightness(1.2);
        }

        .svg-text {
            font-family: var(--font-display);
            fill: var(--text-primary);
        }

        .svg-text-mono {
            font-family: var(--font-mono);
        }

        .svg-text-dim {
            fill: var(--text-muted);
            font-size: 12px;
        }

        /* Animated flow lines */
        .flow-line {
            stroke-dasharray: 8 4;
            animation: flowDash 1s linear infinite;
        }

        @keyframes flowDash {
            to { stroke-dashoffset: -12; }
        }

        /* Glow effects */
        .glow-cyan { filter: drop-shadow(0 0 8px rgba(0, 217, 255, 0.5)); }
        .glow-purple { filter: drop-shadow(0 0 8px rgba(163, 113, 247, 0.5)); }
        .glow-green { filter: drop-shadow(0 0 8px rgba(63, 185, 80, 0.5)); }
        .glow-orange { filter: drop-shadow(0 0 8px rgba(210, 153, 34, 0.5)); }

        /* Pulse animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        /* Fade in animations for slide content */
        .slide.active .fade-in {
            animation: fadeIn 0.6s ease forwards;
        }

        .slide.active .fade-in-delay-1 { animation-delay: 0.1s; opacity: 0; }
        .slide.active .fade-in-delay-2 { animation-delay: 0.2s; opacity: 0; }
        .slide.active .fade-in-delay-3 { animation-delay: 0.3s; opacity: 0; }
        .slide.active .fade-in-delay-4 { animation-delay: 0.4s; opacity: 0; }
        .slide.active .fade-in-delay-5 { animation-delay: 0.5s; opacity: 0; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Section divider */
        .section-badge {
            display: inline-block;
            padding: 0.4rem 1rem;
            background: var(--bg-tertiary);
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
        }

        /* Two-column layout */
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        /* Architecture boxes */
        .arch-box {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .arch-box-cyan {
            background: linear-gradient(135deg, rgba(0, 217, 255, 0.15) 0%, rgba(0, 217, 255, 0.05) 100%);
            border-left: 3px solid var(--accent-cyan);
        }

        .arch-box-purple {
            background: linear-gradient(135deg, rgba(163, 113, 247, 0.15) 0%, rgba(163, 113, 247, 0.05) 100%);
            border-left: 3px solid var(--accent-purple);
        }

        .arch-box-green {
            background: linear-gradient(135deg, rgba(63, 185, 80, 0.15) 0%, rgba(63, 185, 80, 0.05) 100%);
            border-left: 3px solid var(--accent-green);
        }

        .arch-box-orange {
            background: linear-gradient(135deg, rgba(210, 153, 34, 0.15) 0%, rgba(210, 153, 34, 0.05) 100%);
            border-left: 3px solid var(--accent-orange);
        }

        /* Feature list with icons */
        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
        }

        .feature-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        /* Arrow connector */
        .arrow-down {
            text-align: center;
            color: var(--accent-cyan);
            font-size: 2rem;
            margin: 0.5rem 0;
        }

        /* Table styling */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1rem;
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        th {
            background: var(--bg-secondary);
            color: var(--accent-cyan);
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
        }

        tr:hover {
            background: var(--bg-secondary);
        }

        td code {
            font-family: var(--font-mono);
            background: var(--bg-tertiary);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="presentation">

        <!-- ==================== -->
        <!-- SLIDE 1: Title       -->
        <!-- ==================== -->
        <section class="slide slide-title slide-center active" data-slide="1">
            <div class="fade-in">
                <h1>LIPO</h1>
                <p class="subtitle">Latent Instruction Prompt Optimization</p>
            </div>
            <p class="authors fade-in fade-in-delay-2">
                Bayesian Optimization in VAE Latent Space<br>
                with Vec2Text Inversion
            </p>
            <div style="margin-top: 3rem;" class="fade-in fade-in-delay-3">
                <span class="dim-badge">768D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-green); color: var(--accent-green);">Text</span>
            </div>
        </section>

        <!-- ==================== -->
        <!-- SLIDE 2: Motivation  -->
        <!-- ==================== -->
        <section class="slide" data-slide="2">
            <span class="section-badge fade-in">Introduction</span>
            <h2 class="fade-in fade-in-delay-1">Motivation</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3 style="color: var(--accent-orange);">The Problem</h3>
                    <ul>
                        <li>Manual prompt engineering is <strong>time-consuming</strong></li>
                        <li>Discrete text space is <strong>non-differentiable</strong></li>
                        <li>Evaluation requires <strong>expensive LLM calls</strong></li>
                        <li>Search space is <strong>combinatorially large</strong></li>
                    </ul>

                    <div class="highlight-box highlight-orange" style="margin-top: 2rem;">
                        <p style="font-size: 1.1rem; color: var(--text-primary);">
                            <strong>Challenge:</strong> How to efficiently optimize prompts when each evaluation costs significant compute?
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3 style="color: var(--accent-green);">Our Solution: LIPO</h3>
                    <ul>
                        <li>Map prompts to <strong>continuous latent space</strong></li>
                        <li>Use <strong>Bayesian Optimization</strong> for sample efficiency</li>
                        <li>Apply <strong>multi-fidelity</strong> evaluation (Hyperband)</li>
                        <li>Invert latents back to text via <strong>Vec2Text</strong></li>
                    </ul>

                    <div class="highlight-box highlight-green" style="margin-top: 2rem;">
                        <p style="font-size: 1.1rem; color: var(--text-primary);">
                            <strong>Result:</strong> Efficient gradient-based optimization in latent space with text generation
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== -->
        <!-- SLIDE 3: Contributions -->
        <!-- ==================== -->
        <section class="slide" data-slide="3">
            <span class="section-badge fade-in">Introduction</span>
            <h2 class="fade-in fade-in-delay-1">Key Contributions</h2>

            <div class="content-full" style="justify-content: center;">
                <ul class="feature-list">
                    <li class="fade-in fade-in-delay-1">
                        <div class="feature-icon" style="background: var(--gradient-cyan);">üîÆ</div>
                        <div>
                            <strong style="color: var(--accent-cyan);">VAE Latent Representation</strong>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                32D compressed latent space with KL-regularization for smooth optimization landscape
                            </p>
                        </div>
                    </li>
                    <li class="fade-in fade-in-delay-2">
                        <div class="feature-icon" style="background: var(--gradient-purple);">üìä</div>
                        <div>
                            <strong style="color: var(--accent-purple);">ARD Gaussian Process</strong>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                Automatic Relevance Determination learns dimension importance with Mat√©rn 5/2 kernel
                            </p>
                        </div>
                    </li>
                    <li class="fade-in fade-in-delay-3">
                        <div class="feature-icon" style="background: var(--gradient-green);">‚ö°</div>
                        <div>
                            <strong style="color: var(--accent-green);">Multi-Fidelity Optimization</strong>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                Hyperband with BO proposals for efficient budget allocation across evaluation fidelities
                            </p>
                        </div>
                    </li>
                    <li class="fade-in fade-in-delay-4">
                        <div class="feature-icon" style="background: var(--gradient-orange);">üîÑ</div>
                        <div>
                            <strong style="color: var(--accent-orange);">Vec2Text Inversion</strong>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                ZSInvert refinement with fixed-target approach for stable text generation
                            </p>
                        </div>
                    </li>
                </ul>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 4: Architecture     -->
        <!-- ========================= -->
        <section class="slide" data-slide="4">
            <h2 class="fade-in" style="text-align: center; margin-bottom: 0.5rem;">LIPO Architecture</h2>
            <p class="fade-in fade-in-delay-1" style="text-align: center; margin-bottom: 1rem;">End-to-end pipeline for instruction prompt optimization</p>

            <div class="diagram-container fade-in fade-in-delay-2">
                <svg viewBox="0 0 1200 600" xmlns="http://www.w3.org/2000/svg">
                    <!-- Definitions -->
                    <defs>
                        <!-- Gradients -->
                        <linearGradient id="gradCyan" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#00d9ff;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#0099cc;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradPurple" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#a371f7;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#8957e5;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradGreen" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#3fb950;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#238636;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradOrange" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#d29922;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#bb8009;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="gradMagenta" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#f778ba;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#db61a2;stop-opacity:1" />
                        </linearGradient>

                        <!-- Glow filters -->
                        <filter id="glowCyan" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                            <feMerge>
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                        <filter id="glowPurple" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                            <feMerge>
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>

                        <!-- Arrow marker -->
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff"/>
                        </marker>
                        <marker id="arrowheadCyan" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#00d9ff"/>
                        </marker>
                    </defs>

                    <!-- Phase Labels -->
                    <text x="100" y="30" fill="#6e7681" font-size="12" font-family="Outfit">PHASE 1</text>
                    <text x="320" y="30" fill="#6e7681" font-size="12" font-family="Outfit">PHASE 2</text>
                    <text x="560" y="30" fill="#6e7681" font-size="12" font-family="Outfit">PHASE 3</text>
                    <text x="850" y="30" fill="#6e7681" font-size="12" font-family="Outfit">PHASE 4</text>
                    <text x="1050" y="30" fill="#6e7681" font-size="12" font-family="Outfit">OUTPUT</text>

                    <!-- PHASE 1: APE + GTR -->
                    <g class="svg-node" filter="url(#glowCyan)">
                        <rect x="30" y="80" width="160" height="70" rx="8" fill="url(#gradCyan)" opacity="0.9"/>
                        <text x="110" y="110" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="Outfit">APE Generation</text>
                        <text x="110" y="130" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="JetBrains Mono">2000 instructions</text>
                    </g>

                    <!-- Arrow -->
                    <line x1="110" y1="150" x2="110" y2="180" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                    <g class="svg-node" filter="url(#glowCyan)">
                        <rect x="30" y="190" width="160" height="70" rx="8" fill="url(#gradCyan)" opacity="0.9"/>
                        <text x="110" y="220" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="Outfit">GTR Encoder</text>
                        <text x="110" y="240" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="JetBrains Mono">768D embeddings</text>
                    </g>

                    <!-- Arrow to VAE -->
                    <line x1="190" y1="225" x2="240" y2="225" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                    <!-- PHASE 2: VAE -->
                    <g class="svg-node" filter="url(#glowPurple)">
                        <rect x="250" y="140" width="180" height="170" rx="8" fill="#161b22" stroke="url(#gradPurple)" stroke-width="2"/>

                        <!-- VAE Internal -->
                        <text x="340" y="165" text-anchor="middle" fill="#a371f7" font-size="14" font-weight="600" font-family="Outfit">InstructionVAE</text>

                        <!-- Encoder block -->
                        <rect x="265" y="180" width="70" height="50" rx="4" fill="rgba(163,113,247,0.3)"/>
                        <text x="300" y="200" text-anchor="middle" fill="#e6edf3" font-size="10" font-family="Outfit">Encoder</text>
                        <text x="300" y="215" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">768‚Üí32</text>

                        <!-- Latent -->
                        <rect x="280" y="240" width="40" height="30" rx="4" fill="#a371f7"/>
                        <text x="300" y="260" text-anchor="middle" fill="#0a0e14" font-size="10" font-weight="600" font-family="JetBrains Mono">z</text>

                        <!-- Decoder block -->
                        <rect x="345" y="180" width="70" height="50" rx="4" fill="rgba(163,113,247,0.3)"/>
                        <text x="380" y="200" text-anchor="middle" fill="#e6edf3" font-size="10" font-family="Outfit">Decoder</text>
                        <text x="380" y="215" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">32‚Üí768</text>

                        <!-- Dimension label -->
                        <rect x="285" y="280" width="110" height="22" rx="11" fill="#21262d" stroke="#a371f7" stroke-width="1"/>
                        <text x="340" y="295" text-anchor="middle" fill="#a371f7" font-size="10" font-family="JetBrains Mono">32D latent space</text>
                    </g>

                    <!-- Arrow to Hyperband -->
                    <line x1="430" y1="225" x2="480" y2="225" stroke="#a371f7" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- PHASE 3: Hyperband + GP -->
                    <g class="svg-node">
                        <rect x="490" y="80" width="200" height="130" rx="8" fill="#161b22" stroke="url(#gradGreen)" stroke-width="2"/>
                        <text x="590" y="105" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="600" font-family="Outfit">Hyperband</text>
                        <text x="590" y="125" text-anchor="middle" fill="#8b949e" font-size="11" font-family="Outfit">Successive Halving + BO</text>

                        <!-- Mini brackets visualization -->
                        <rect x="510" y="140" width="30" height="25" rx="3" fill="rgba(63,185,80,0.4)"/>
                        <rect x="545" y="145" width="25" height="20" rx="3" fill="rgba(63,185,80,0.5)"/>
                        <rect x="575" y="150" width="20" height="15" rx="3" fill="rgba(63,185,80,0.6)"/>
                        <rect x="600" y="155" width="15" height="10" rx="2" fill="#3fb950"/>

                        <text x="590" y="190" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">Œ∑=2, fidelity: 10‚Üí1319</text>
                    </g>

                    <!-- Arrow down to GP -->
                    <line x1="590" y1="210" x2="590" y2="240" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <g class="svg-node">
                        <rect x="490" y="250" width="200" height="100" rx="8" fill="#161b22" stroke="url(#gradGreen)" stroke-width="2"/>
                        <text x="590" y="280" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="600" font-family="Outfit">Gaussian Process</text>
                        <text x="590" y="300" text-anchor="middle" fill="#8b949e" font-size="11" font-family="Outfit">ARD Mat√©rn 5/2 Kernel</text>
                        <text x="590" y="320" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">32 lengthscales</text>
                        <text x="590" y="338" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">‚Üí qLogEI acquisition</text>
                    </g>

                    <!-- Arrow to InvBO -->
                    <line x1="690" y1="300" x2="740" y2="300" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- PHASE 4: InvBO Loop -->
                    <g class="svg-node">
                        <rect x="750" y="60" width="220" height="320" rx="8" fill="#161b22" stroke="url(#gradOrange)" stroke-width="2"/>
                        <text x="860" y="90" text-anchor="middle" fill="#d29922" font-size="14" font-weight="600" font-family="Outfit">InvBO Loop</text>

                        <!-- TuRBO -->
                        <rect x="770" y="110" width="180" height="45" rx="6" fill="rgba(210,153,34,0.2)" stroke="#d29922" stroke-width="1"/>
                        <text x="860" y="130" text-anchor="middle" fill="#d29922" font-size="12" font-weight="500" font-family="Outfit">TuRBO Trust Region</text>
                        <text x="860" y="145" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">L: 0.4 ‚Üí 0.8 (adaptive)</text>

                        <!-- PAS -->
                        <rect x="770" y="165" width="180" height="45" rx="6" fill="rgba(247,120,186,0.2)" stroke="#f778ba" stroke-width="1"/>
                        <text x="860" y="185" text-anchor="middle" fill="#f778ba" font-size="12" font-weight="500" font-family="Outfit">PAS Anchor Selection</text>
                        <text x="860" y="200" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">Thompson Sampling</text>

                        <!-- BoTorch -->
                        <rect x="770" y="220" width="180" height="45" rx="6" fill="rgba(88,166,255,0.2)" stroke="#58a6ff" stroke-width="1"/>
                        <text x="860" y="240" text-anchor="middle" fill="#58a6ff" font-size="12" font-weight="500" font-family="Outfit">BoTorch qLogEI</text>
                        <text x="860" y="255" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">64 restarts, L-BFGS-B</text>

                        <!-- Vec2Text -->
                        <rect x="770" y="275" width="180" height="45" rx="6" fill="rgba(163,113,247,0.2)" stroke="#a371f7" stroke-width="1"/>
                        <text x="860" y="295" text-anchor="middle" fill="#a371f7" font-size="12" font-weight="500" font-family="Outfit">Vec2Text Inversion</text>
                        <text x="860" y="310" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">+ ZSInvert refinement</text>

                        <!-- Loop arrow -->
                        <path d="M 950 180 Q 970 180 970 240 Q 970 300 950 300" fill="none" stroke="#d29922" stroke-width="2" stroke-dasharray="4 2"/>
                        <text x="980" y="245" fill="#d29922" font-size="10" font-family="Outfit" transform="rotate(90, 980, 245)">iterate</text>

                        <!-- Feedback -->
                        <text x="860" y="365" text-anchor="middle" fill="#6e7681" font-size="10" font-family="Outfit">GP retrain after evaluation</text>
                    </g>

                    <!-- Arrow to Output -->
                    <line x1="970" y1="220" x2="1010" y2="220" stroke="#d29922" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- OUTPUT -->
                    <g class="svg-node" filter="url(#glowCyan)">
                        <rect x="1020" y="170" width="150" height="100" rx="8" fill="url(#gradGreen)" opacity="0.9"/>
                        <text x="1095" y="200" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="Outfit">Optimized</text>
                        <text x="1095" y="220" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="Outfit">Instruction</text>
                        <text x="1095" y="250" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="JetBrains Mono">min error_rate</text>
                    </g>

                    <!-- Bottom: Dimension flow -->
                    <g transform="translate(0, 420)">
                        <rect x="30" y="0" width="1140" height="60" rx="8" fill="rgba(33,38,45,0.8)"/>
                        <text x="60" y="25" fill="#6e7681" font-size="12" font-family="Outfit">DIMENSION FLOW:</text>

                        <rect x="180" y="15" width="80" height="30" rx="4" fill="rgba(0,217,255,0.2)" stroke="#00d9ff"/>
                        <text x="220" y="35" text-anchor="middle" fill="#00d9ff" font-size="12" font-family="JetBrains Mono">Text</text>

                        <text x="280" y="35" fill="#6e7681" font-size="16">‚Üí</text>

                        <rect x="300" y="15" width="80" height="30" rx="4" fill="rgba(0,217,255,0.2)" stroke="#00d9ff"/>
                        <text x="340" y="35" text-anchor="middle" fill="#00d9ff" font-size="12" font-family="JetBrains Mono">768D</text>

                        <text x="400" y="35" fill="#6e7681" font-size="16">‚Üí</text>

                        <rect x="420" y="15" width="80" height="30" rx="4" fill="rgba(163,113,247,0.2)" stroke="#a371f7"/>
                        <text x="460" y="35" text-anchor="middle" fill="#a371f7" font-size="12" font-family="JetBrains Mono">32D</text>

                        <text x="520" y="35" fill="#6e7681" font-size="16">‚Üí</text>

                        <rect x="540" y="15" width="100" height="30" rx="4" fill="rgba(63,185,80,0.2)" stroke="#3fb950"/>
                        <text x="590" y="35" text-anchor="middle" fill="#3fb950" font-size="12" font-family="JetBrains Mono">GP predict</text>

                        <text x="660" y="35" fill="#6e7681" font-size="16">‚Üí</text>

                        <rect x="680" y="15" width="100" height="30" rx="4" fill="rgba(210,153,34,0.2)" stroke="#d29922"/>
                        <text x="730" y="35" text-anchor="middle" fill="#d29922" font-size="12" font-family="JetBrains Mono">z_opt (32D)</text>

                        <text x="800" y="35" fill="#6e7681" font-size="16">‚Üí</text>

                        <rect x="820" y="15" width="100" height="30" rx="4" fill="rgba(163,113,247,0.2)" stroke="#a371f7"/>
                        <text x="870" y="35" text-anchor="middle" fill="#a371f7" font-size="12" font-family="JetBrains Mono">768D</text>

                        <text x="940" y="35" fill="#6e7681" font-size="16">‚Üí</text>

                        <rect x="960" y="15" width="100" height="30" rx="4" fill="rgba(63,185,80,0.2)" stroke="#3fb950"/>
                        <text x="1010" y="35" text-anchor="middle" fill="#3fb950" font-size="12" font-family="JetBrains Mono">Text</text>

                        <text x="1100" y="35" fill="#3fb950" font-size="14">‚úì</text>
                    </g>

                    <!-- Legend -->
                    <g transform="translate(30, 510)">
                        <rect x="0" y="0" width="1140" height="40" rx="6" fill="rgba(22,27,34,0.9)"/>

                        <circle cx="30" cy="20" r="6" fill="#00d9ff"/>
                        <text x="45" y="24" fill="#8b949e" font-size="11" font-family="Outfit">Encoding</text>

                        <circle cx="150" cy="20" r="6" fill="#a371f7"/>
                        <text x="165" y="24" fill="#8b949e" font-size="11" font-family="Outfit">Latent Space</text>

                        <circle cx="290" cy="20" r="6" fill="#3fb950"/>
                        <text x="305" y="24" fill="#8b949e" font-size="11" font-family="Outfit">Optimization</text>

                        <circle cx="430" cy="20" r="6" fill="#d29922"/>
                        <text x="445" y="24" fill="#8b949e" font-size="11" font-family="Outfit">InvBO Loop</text>

                        <circle cx="560" cy="20" r="6" fill="#f778ba"/>
                        <text x="575" y="24" fill="#8b949e" font-size="11" font-family="Outfit">Anchor Selection</text>

                        <circle cx="720" cy="20" r="6" fill="#58a6ff"/>
                        <text x="735" y="24" fill="#8b949e" font-size="11" font-family="Outfit">Acquisition</text>
                    </g>
                </svg>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 5: Data Flow        -->
        <!-- ========================= -->
        <section class="slide" data-slide="5">
            <span class="section-badge fade-in">Architecture</span>
            <h2 class="fade-in fade-in-delay-1">Data Flow Summary</h2>

            <div class="content-full" style="justify-content: center;">
                <div class="two-col">
                    <div class="fade-in fade-in-delay-2">
                        <h3 style="color: var(--accent-cyan);">Forward Pass (Training)</h3>

                        <div class="arch-box arch-box-cyan">
                            <span class="dim-badge">Text</span>
                            <span>‚Üí GTR Encoder ‚Üí</span>
                            <span class="dim-badge">768D</span>
                        </div>
                        <div class="arrow-down">‚Üì</div>
                        <div class="arch-box arch-box-purple">
                            <span class="dim-badge">768D</span>
                            <span>‚Üí VAE Encoder ‚Üí</span>
                            <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                        </div>
                        <div class="arrow-down" style="color: var(--accent-purple);">‚Üì</div>
                        <div class="arch-box arch-box-green">
                            <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                            <span>‚Üí GP Training ‚Üí</span>
                            <span style="color: var(--accent-green);">Œº(z), œÉ(z)</span>
                        </div>
                    </div>

                    <div class="fade-in fade-in-delay-3">
                        <h3 style="color: var(--accent-orange);">Inversion (Inference)</h3>

                        <div class="arch-box arch-box-orange">
                            <span style="color: var(--accent-orange);">qLogEI</span>
                            <span>‚Üí optimize ‚Üí</span>
                            <span class="dim-badge" style="border-color: var(--accent-orange); color: var(--accent-orange);">z_opt</span>
                        </div>
                        <div class="arrow-down" style="color: var(--accent-orange);">‚Üì</div>
                        <div class="arch-box arch-box-purple">
                            <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                            <span>‚Üí VAE Decoder ‚Üí</span>
                            <span class="dim-badge">768D</span>
                        </div>
                        <div class="arrow-down" style="color: var(--accent-purple);">‚Üì</div>
                        <div class="arch-box arch-box-green">
                            <span class="dim-badge">768D</span>
                            <span>‚Üí Vec2Text ‚Üí</span>
                            <span class="dim-badge" style="border-color: var(--accent-green); color: var(--accent-green);">Text</span>
                        </div>
                    </div>
                </div>

                <div class="highlight-box highlight-purple fade-in fade-in-delay-4" style="margin-top: 2rem; text-align: center;">
                    <p style="font-size: 1.1rem; color: var(--text-primary);">
                        <strong>Key Insight:</strong> 32D latent space enables gradient-based optimization while preserving semantic structure
                    </p>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 6: APE Generation   -->
        <!-- ========================= -->
        <section class="slide" data-slide="6">
            <span class="section-badge fade-in">Phase 1: Instruction Generation</span>
            <h2 class="fade-in fade-in-delay-1">APE: Automatic Prompt Engineering</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Generation Strategy</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Diverse instruction set generated using 5 style categories with varying temperatures.
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>Style</th>
                                <th>Temp</th>
                                <th>Characteristics</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>minimalist</code></td>
                                <td>1.0</td>
                                <td>~5 words, concise</td>
                            </tr>
                            <tr>
                                <td><code>direct_command</code></td>
                                <td>0.9</td>
                                <td>10-15 words, imperative</td>
                            </tr>
                            <tr>
                                <td><code>chain_of_thought</code></td>
                                <td>0.8</td>
                                <td>Step-by-step prompting</td>
                            </tr>
                            <tr>
                                <td><code>pedagogical</code></td>
                                <td>0.9</td>
                                <td>Teacher persona</td>
                            </tr>
                            <tr>
                                <td><code>analytical</code></td>
                                <td>0.8</td>
                                <td>Logical structure</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="card card-glow">
                        <h3 style="color: var(--accent-cyan); margin-bottom: 1rem;">Configuration</h3>
                        <div class="code-block">
<span class="comment"># APE parameters</span>
<span class="function">ape_num_instructions</span> = <span class="number">2000</span>
<span class="function">ape_model</span> = <span class="string">"Qwen/Qwen2.5-7B"</span>
<span class="function">ape_batch_size</span> = <span class="number">10</span>
<span class="function">ape_max_tokens</span> = <span class="number">100</span>
<span class="function">ape_max_length</span> = <span class="number">500</span>
                        </div>
                    </div>

                    <div class="highlight-box highlight-cyan" style="margin-top: 1.5rem;">
                        <strong style="color: var(--accent-cyan);">Why 2000 instructions?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Provides sufficient diversity for VAE training while maintaining computational tractability. ~400 per style category.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 7: GTR Encoder      -->
        <!-- ========================= -->
        <section class="slide" data-slide="7">
            <span class="section-badge fade-in">Phase 1: Instruction Generation</span>
            <h2 class="fade-in fade-in-delay-1">GTR Encoder</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>SentenceTransformer GTR-T5-Base</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Produces L2-normalized 768D embeddings compatible with Vec2Text inversion.
                    </p>

                    <ul class="feature-list">
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üìê</div>
                            <div>
                                <strong>768-dimensional</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Dense semantic representation</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üîÑ</div>
                            <div>
                                <strong>L2-normalized</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Required for Vec2Text compatibility</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">‚ö°</div>
                            <div>
                                <strong>Batch processing</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Efficient encoding with batch_size=32</p>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 300px;">
                        <svg viewBox="0 0 400 280" xmlns="http://www.w3.org/2000/svg">
                            <!-- Input text -->
                            <rect x="50" y="20" width="300" height="50" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                            <text x="200" y="50" text-anchor="middle" fill="#e6edf3" font-size="14" font-family="Outfit">"Solve the problem step by step"</text>

                            <!-- Arrow -->
                            <line x1="200" y1="70" x2="200" y2="100" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                            <!-- GTR box -->
                            <rect x="100" y="110" width="200" height="60" rx="8" fill="url(#gradCyan)"/>
                            <text x="200" y="135" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="Outfit">GTR-T5-Base</text>
                            <text x="200" y="155" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="JetBrains Mono">SentenceTransformer</text>

                            <!-- Arrow -->
                            <line x1="200" y1="170" x2="200" y2="200" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                            <!-- Output embedding -->
                            <rect x="50" y="210" width="300" height="50" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                            <text x="200" y="235" text-anchor="middle" fill="#00d9ff" font-size="12" font-family="JetBrains Mono">[0.023, -0.118, ..., 0.045]</text>
                            <text x="200" y="252" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">768D, ||x|| = 1</text>
                        </svg>
                    </div>

                    <div class="code-block" style="margin-top: 1rem;">
<span class="keyword">class</span> <span class="function">GTRInstructionEncoder</span>:
    <span class="function">embedding_dim</span> = <span class="number">768</span>
    <span class="function">normalize</span> = <span class="keyword">True</span>  <span class="comment"># L2 norm</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 8: VAE Architecture -->
        <!-- ========================= -->
        <section class="slide" data-slide="8">
            <span class="section-badge fade-in">Phase 2: Representation Learning</span>
            <h2 class="fade-in fade-in-delay-1">VAE Architecture</h2>

            <div class="diagram-container fade-in fade-in-delay-2" style="flex: 1;">
                <svg viewBox="0 0 1100 400" xmlns="http://www.w3.org/2000/svg">
                    <!-- Title -->
                    <text x="550" y="30" text-anchor="middle" fill="#a371f7" font-size="16" font-weight="600" font-family="Outfit">InstructionVAE: 768D ‚Üí 32D ‚Üí 768D</text>

                    <!-- ENCODER SIDE -->
                    <text x="280" y="60" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">ENCODER</text>

                    <!-- Input layer -->
                    <rect x="50" y="100" width="120" height="200" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                    <text x="110" y="140" text-anchor="middle" fill="#00d9ff" font-size="14" font-weight="500" font-family="Outfit">Input</text>
                    <text x="110" y="200" text-anchor="middle" fill="#00d9ff" font-size="24" font-weight="600" font-family="JetBrains Mono">768</text>
                    <text x="110" y="270" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">GTR embedding</text>

                    <!-- Arrow -->
                    <line x1="170" y1="200" x2="200" y2="200" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                    <!-- Hidden 1 -->
                    <rect x="210" y="120" width="80" height="160" rx="6" fill="rgba(163,113,247,0.3)" stroke="#a371f7" stroke-width="1"/>
                    <text x="250" y="180" text-anchor="middle" fill="#a371f7" font-size="12" font-family="Outfit">Linear</text>
                    <text x="250" y="200" text-anchor="middle" fill="#a371f7" font-size="18" font-weight="600" font-family="JetBrains Mono">384</text>
                    <text x="250" y="225" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="290" y1="200" x2="320" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 2 -->
                    <rect x="330" y="140" width="70" height="120" rx="6" fill="rgba(163,113,247,0.4)" stroke="#a371f7" stroke-width="1"/>
                    <text x="365" y="180" text-anchor="middle" fill="#a371f7" font-size="12" font-family="Outfit">Linear</text>
                    <text x="365" y="200" text-anchor="middle" fill="#a371f7" font-size="18" font-weight="600" font-family="JetBrains Mono">192</text>
                    <text x="365" y="225" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="400" y1="200" x2="430" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Mu and LogVar -->
                    <rect x="440" y="100" width="60" height="80" rx="6" fill="rgba(163,113,247,0.5)" stroke="#a371f7" stroke-width="2"/>
                    <text x="470" y="130" text-anchor="middle" fill="#e6edf3" font-size="14" font-weight="600" font-family="Outfit">Œº</text>
                    <text x="470" y="160" text-anchor="middle" fill="#a371f7" font-size="14" font-family="JetBrains Mono">32</text>

                    <rect x="440" y="220" width="60" height="80" rx="6" fill="rgba(163,113,247,0.5)" stroke="#a371f7" stroke-width="2"/>
                    <text x="470" y="250" text-anchor="middle" fill="#e6edf3" font-size="14" font-weight="600" font-family="Outfit">log œÉ¬≤</text>
                    <text x="470" y="280" text-anchor="middle" fill="#a371f7" font-size="14" font-family="JetBrains Mono">32</text>

                    <!-- Reparameterization -->
                    <text x="550" y="90" text-anchor="middle" fill="#d29922" font-size="11" font-family="Outfit">Reparameterization</text>
                    <circle cx="550" cy="200" r="30" fill="rgba(210,153,34,0.3)" stroke="#d29922" stroke-width="2"/>
                    <text x="550" y="195" text-anchor="middle" fill="#d29922" font-size="12" font-weight="600" font-family="Outfit">z =</text>
                    <text x="550" y="210" text-anchor="middle" fill="#d29922" font-size="10" font-family="JetBrains Mono">Œº+œÉ¬∑Œµ</text>

                    <!-- Arrows to reparam -->
                    <line x1="500" y1="140" x2="525" y2="180" stroke="#a371f7" stroke-width="2"/>
                    <line x1="500" y1="260" x2="525" y2="220" stroke="#a371f7" stroke-width="2"/>

                    <!-- Latent z -->
                    <rect x="610" y="160" width="60" height="80" rx="8" fill="#a371f7"/>
                    <text x="640" y="195" text-anchor="middle" fill="#0a0e14" font-size="16" font-weight="700" font-family="Outfit">z</text>
                    <text x="640" y="220" text-anchor="middle" fill="#0a0e14" font-size="14" font-weight="600" font-family="JetBrains Mono">32D</text>

                    <!-- Arrow from reparam -->
                    <line x1="580" y1="200" x2="610" y2="200" stroke="#d29922" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- DECODER SIDE -->
                    <text x="850" y="60" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">DECODER</text>

                    <!-- Arrow to decoder -->
                    <line x1="670" y1="200" x2="700" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 2 (decoder) -->
                    <rect x="710" y="140" width="70" height="120" rx="6" fill="rgba(163,113,247,0.4)" stroke="#a371f7" stroke-width="1"/>
                    <text x="745" y="180" text-anchor="middle" fill="#a371f7" font-size="12" font-family="Outfit">Linear</text>
                    <text x="745" y="200" text-anchor="middle" fill="#a371f7" font-size="18" font-weight="600" font-family="JetBrains Mono">192</text>
                    <text x="745" y="225" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="780" y1="200" x2="810" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Hidden 1 (decoder) -->
                    <rect x="820" y="120" width="80" height="160" rx="6" fill="rgba(163,113,247,0.3)" stroke="#a371f7" stroke-width="1"/>
                    <text x="860" y="180" text-anchor="middle" fill="#a371f7" font-size="12" font-family="Outfit">Linear</text>
                    <text x="860" y="200" text-anchor="middle" fill="#a371f7" font-size="18" font-weight="600" font-family="JetBrains Mono">384</text>
                    <text x="860" y="225" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">GELU+LN</text>

                    <!-- Arrow -->
                    <line x1="900" y1="200" x2="930" y2="200" stroke="#a371f7" stroke-width="2"/>

                    <!-- Output layer -->
                    <rect x="940" y="100" width="120" height="200" rx="8" fill="rgba(63,185,80,0.2)" stroke="#3fb950" stroke-width="2"/>
                    <text x="1000" y="140" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="500" font-family="Outfit">Output</text>
                    <text x="1000" y="200" text-anchor="middle" fill="#3fb950" font-size="24" font-weight="600" font-family="JetBrains Mono">768</text>
                    <text x="1000" y="270" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">L2 normalized</text>

                    <!-- Compression ratio -->
                    <rect x="450" y="330" width="200" height="40" rx="6" fill="rgba(163,113,247,0.2)" stroke="#a371f7" stroke-width="1"/>
                    <text x="550" y="355" text-anchor="middle" fill="#a371f7" font-size="12" font-family="Outfit">24√ó compression (768/32)</text>
                </svg>
            </div>

            <div class="two-col fade-in fade-in-delay-3" style="margin-top: 1rem;">
                <div class="highlight-box highlight-purple">
                    <strong>Encoder:</strong> 768 ‚Üí 384 ‚Üí 192 ‚Üí 64 (Œº + log œÉ¬≤)
                </div>
                <div class="highlight-box highlight-green">
                    <strong>Decoder:</strong> 32 ‚Üí 192 ‚Üí 384 ‚Üí 768 (L2 norm)
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 9: VAE Loss         -->
        <!-- ========================= -->
        <section class="slide" data-slide="9">
            <span class="section-badge fade-in">Phase 2: Representation Learning</span>
            <h2 class="fade-in fade-in-delay-1">VAE Loss Function</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Total Loss</h3>
                    <div class="math-block">
                        $$\mathcal{L} = \mathcal{L}_{\text{recon}} + \beta \cdot \mathcal{L}_{\text{KL}} + \gamma \cdot \mathcal{L}_{\text{cycle}}$$
                    </div>

                    <div class="card" style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 0.75rem;">Reconstruction Loss</h4>
                        <div class="math-block" style="margin: 0; font-size: 1.1rem;">
                            $$\mathcal{L}_{\text{recon}} = 1 - \cos(\mathbf{x}, \hat{\mathbf{x}})$$
                        </div>
                        <p style="margin-top: 0.75rem; font-size: 0.95rem; color: var(--text-muted);">
                            Cosine similarity for normalized embeddings
                        </p>
                    </div>

                    <div class="card" style="margin-top: 1rem;">
                        <h4 style="color: var(--accent-purple); margin-bottom: 0.75rem;">KL Divergence</h4>
                        <div class="math-block" style="margin: 0; font-size: 1.1rem;">
                            $$\mathcal{L}_{\text{KL}} = -\frac{1}{2}\sum_i \left(1 + \log\sigma_i^2 - \mu_i^2 - \sigma_i^2\right)$$
                        </div>
                        <p style="margin-top: 0.75rem; font-size: 0.95rem; color: var(--text-muted);">
                            Regularization towards N(0, 1) prior
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Parameters</h3>
                    <table>
                        <tr>
                            <td><code>Œ≤</code></td>
                            <td style="color: var(--accent-purple);">0.01</td>
                            <td>KL weight (after annealing)</td>
                        </tr>
                        <tr>
                            <td><code>Œ≥</code></td>
                            <td style="color: var(--text-muted);">0.0</td>
                            <td>Cycle consistency (disabled)</td>
                        </tr>
                        <tr>
                            <td><code>epochs</code></td>
                            <td style="color: var(--accent-green);">20000</td>
                            <td>Maximum training epochs</td>
                        </tr>
                        <tr>
                            <td><code>lr</code></td>
                            <td style="color: var(--accent-cyan);">0.0006</td>
                            <td>AdamW learning rate</td>
                        </tr>
                        <tr>
                            <td><code>patience</code></td>
                            <td style="color: var(--accent-orange);">500</td>
                            <td>Early stopping</td>
                        </tr>
                    </table>

                    <div class="highlight-box highlight-purple" style="margin-top: 1.5rem;">
                        <strong>Why cosine loss?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            GTR embeddings are L2-normalized. Cosine similarity directly measures semantic alignment on the unit sphere.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 10: KL Annealing    -->
        <!-- ========================= -->
        <section class="slide" data-slide="10">
            <span class="section-badge fade-in">Phase 2: Representation Learning</span>
            <h2 class="fade-in fade-in-delay-1">KL Annealing</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Annealing Schedule</h3>
                    <div class="math-block">
                        $$\beta(t) = \begin{cases} \beta_{\max} \cdot \frac{t}{T_{\text{anneal}}} & t < T_{\text{anneal}} \\ \beta_{\max} = 0.01 & t \geq T_{\text{anneal}} \end{cases}$$
                    </div>

                    <div class="highlight-box highlight-orange" style="margin-top: 1.5rem;">
                        <strong>Why annealing?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Prevents <em>posterior collapse</em>: early training focuses on reconstruction, then gradually enforces smooth latent structure.
                        </p>
                    </div>

                    <table style="margin-top: 1.5rem;">
                        <tr>
                            <td><code>annealing_epochs</code></td>
                            <td style="color: var(--accent-orange);">500</td>
                        </tr>
                        <tr>
                            <td><code>Œ≤_max</code></td>
                            <td style="color: var(--accent-purple);">0.01</td>
                        </tr>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 300px;">
                        <svg viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg">
                            <!-- Axes -->
                            <line x1="50" y1="250" x2="380" y2="250" stroke="#6e7681" stroke-width="2"/>
                            <line x1="50" y1="250" x2="50" y2="30" stroke="#6e7681" stroke-width="2"/>

                            <!-- Labels -->
                            <text x="215" y="280" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">Epoch</text>
                            <text x="20" y="140" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit" transform="rotate(-90, 20, 140)">Œ≤</text>

                            <!-- Y-axis labels -->
                            <text x="40" y="255" text-anchor="end" fill="#6e7681" font-size="10" font-family="JetBrains Mono">0</text>
                            <text x="40" y="55" text-anchor="end" fill="#6e7681" font-size="10" font-family="JetBrains Mono">0.01</text>

                            <!-- X-axis labels -->
                            <text x="50" y="265" text-anchor="middle" fill="#6e7681" font-size="10" font-family="JetBrains Mono">0</text>
                            <text x="130" y="265" text-anchor="middle" fill="#6e7681" font-size="10" font-family="JetBrains Mono">500</text>
                            <text x="380" y="265" text-anchor="middle" fill="#6e7681" font-size="10" font-family="JetBrains Mono">20000</text>

                            <!-- Annealing line -->
                            <path d="M 50 250 L 130 50 L 380 50" fill="none" stroke="#a371f7" stroke-width="3"/>

                            <!-- Annealing region -->
                            <rect x="50" y="50" width="80" height="200" fill="rgba(210,153,34,0.1)"/>
                            <text x="90" y="150" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">Annealing</text>

                            <!-- Max Œ≤ line -->
                            <line x1="50" y1="50" x2="380" y2="50" stroke="#a371f7" stroke-width="1" stroke-dasharray="5,5" opacity="0.5"/>
                            <text x="390" y="55" fill="#a371f7" font-size="10" font-family="JetBrains Mono">Œ≤_max</text>

                            <!-- Point at transition -->
                            <circle cx="130" cy="50" r="5" fill="#d29922"/>
                            <text x="130" y="35" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">T=500</text>
                        </svg>
                    </div>

                    <div class="card" style="margin-top: 1rem;">
                        <p style="font-size: 1rem;">
                            <strong style="color: var(--accent-cyan);">Epochs 0-500:</strong> Œ≤ ramps up linearly<br>
                            <strong style="color: var(--accent-purple);">Epochs 500+:</strong> Œ≤ = 0.01 (constant)
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 11: Reparameterization -->
        <!-- ========================= -->
        <section class="slide" data-slide="11">
            <span class="section-badge fade-in">Phase 2: Representation Learning</span>
            <h2 class="fade-in fade-in-delay-1">Reparameterization Trick</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Enabling Backpropagation</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Sampling is non-differentiable. The reparameterization trick moves stochasticity outside the computational graph.
                    </p>

                    <div class="math-block">
                        $$\mathbf{z} = \boldsymbol{\mu} + \boldsymbol{\sigma} \odot \boldsymbol{\epsilon}, \quad \boldsymbol{\epsilon} \sim \mathcal{N}(0, \mathbf{I})$$
                    </div>

                    <div class="highlight-box highlight-green" style="margin-top: 1.5rem;">
                        <strong>Key Property:</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Gradients flow through Œº and œÉ, not through the random sample Œµ.
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 350px;">
                        <svg viewBox="0 0 350 320" xmlns="http://www.w3.org/2000/svg">
                            <!-- Encoder output -->
                            <rect x="20" y="30" width="80" height="50" rx="6" fill="rgba(163,113,247,0.3)" stroke="#a371f7"/>
                            <text x="60" y="55" text-anchor="middle" fill="#a371f7" font-size="14" font-weight="600" font-family="Outfit">Œº</text>
                            <text x="60" y="72" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">32D</text>

                            <rect x="20" y="100" width="80" height="50" rx="6" fill="rgba(163,113,247,0.3)" stroke="#a371f7"/>
                            <text x="60" y="125" text-anchor="middle" fill="#a371f7" font-size="14" font-weight="600" font-family="Outfit">log œÉ¬≤</text>
                            <text x="60" y="142" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">32D</text>

                            <!-- Noise -->
                            <rect x="20" y="180" width="80" height="50" rx="6" fill="rgba(210,153,34,0.3)" stroke="#d29922" stroke-dasharray="4,2"/>
                            <text x="60" y="205" text-anchor="middle" fill="#d29922" font-size="14" font-weight="600" font-family="Outfit">Œµ</text>
                            <text x="60" y="222" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">~N(0,I)</text>

                            <!-- Operations -->
                            <rect x="140" y="100" width="60" height="40" rx="6" fill="rgba(63,185,80,0.3)" stroke="#3fb950"/>
                            <text x="170" y="125" text-anchor="middle" fill="#3fb950" font-size="12" font-weight="500" font-family="Outfit">exp</text>

                            <circle cx="250" cy="160" r="20" fill="rgba(210,153,34,0.3)" stroke="#d29922"/>
                            <text x="250" y="165" text-anchor="middle" fill="#d29922" font-size="16" font-weight="600" font-family="Outfit">√ó</text>

                            <circle cx="250" cy="80" r="20" fill="rgba(63,185,80,0.3)" stroke="#3fb950"/>
                            <text x="250" y="85" text-anchor="middle" fill="#3fb950" font-size="16" font-weight="600" font-family="Outfit">+</text>

                            <!-- Result -->
                            <rect x="280" y="50" width="60" height="60" rx="8" fill="#a371f7"/>
                            <text x="310" y="80" text-anchor="middle" fill="#0a0e14" font-size="18" font-weight="700" font-family="Outfit">z</text>
                            <text x="310" y="100" text-anchor="middle" fill="#0a0e14" font-size="11" font-family="JetBrains Mono">32D</text>

                            <!-- Arrows -->
                            <line x1="100" y1="55" x2="230" y2="75" stroke="#a371f7" stroke-width="2"/>
                            <line x1="100" y1="120" x2="140" y2="120" stroke="#a371f7" stroke-width="2"/>
                            <line x1="200" y1="120" x2="230" y2="145" stroke="#3fb950" stroke-width="2"/>
                            <line x1="100" y1="205" x2="230" y2="170" stroke="#d29922" stroke-width="2" stroke-dasharray="4,2"/>
                            <line x1="250" y1="140" x2="250" y2="100" stroke="#d29922" stroke-width="2"/>
                            <line x1="270" y1="80" x2="280" y2="80" stroke="#3fb950" stroke-width="2"/>

                            <!-- Gradient flow indicator -->
                            <text x="175" y="270" text-anchor="middle" fill="#3fb950" font-size="11" font-family="Outfit">‚úì Gradient flows through Œº, œÉ</text>
                            <text x="175" y="290" text-anchor="middle" fill="#d29922" font-size="11" font-family="Outfit">‚úó No gradient through Œµ</text>
                        </svg>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 12: Round-Trip      -->
        <!-- ========================= -->
        <section class="slide" data-slide="12">
            <span class="section-badge fade-in">Phase 2: Representation Learning</span>
            <h2 class="fade-in fade-in-delay-1">Round-Trip Validation</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Quality Assurance</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Validates that the VAE latent space is smooth and preserves semantic structure.
                    </p>

                    <div class="code-block">
<span class="comment"># Round-trip test</span>
x = GTR.encode(instruction)      <span class="comment"># 768D</span>
z = VAE.encode_mu(x)             <span class="comment"># 32D</span>
x_recon = VAE.decode(z)          <span class="comment"># 768D</span>

cos_sim = cosine(x, x_recon)
<span class="keyword">assert</span> cos_sim >= <span class="number">0.90</span>          <span class="comment"># threshold</span>
                    </div>

                    <div class="highlight-box highlight-green" style="margin-top: 1.5rem;">
                        <strong>Threshold: cos_sim ‚â• 0.90</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Ensures 10th percentile of reconstructions maintains high fidelity.
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="card card-glow">
                        <h4 style="color: var(--accent-purple); margin-bottom: 1rem;">Validation Parameters</h4>
                        <table>
                            <tr>
                                <td><code>threshold</code></td>
                                <td style="color: var(--accent-green);">0.90</td>
                            </tr>
                            <tr>
                                <td><code>samples</code></td>
                                <td style="color: var(--accent-cyan);">20</td>
                            </tr>
                            <tr>
                                <td><code>metric</code></td>
                                <td style="color: var(--accent-purple);">Q<sub>10</sub> (10th percentile)</td>
                            </tr>
                        </table>
                    </div>

                    <div class="card" style="margin-top: 1rem;">
                        <h4 style="color: var(--accent-orange); margin-bottom: 0.75rem;">What it catches</h4>
                        <ul style="font-size: 1rem; padding-left: 1.2rem;">
                            <li>Posterior collapse (all z ‚Üí same point)</li>
                            <li>Latent space "holes"</li>
                            <li>Mode dropping</li>
                            <li>Poor reconstruction quality</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 13: Hyperband      -->
        <!-- ========================= -->
        <section class="slide" data-slide="13">
            <span class="section-badge fade-in">Phase 3: Multi-Fidelity Optimization</span>
            <h2 class="fade-in fade-in-delay-1">Hyperband</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Successive Halving + BO</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Efficient multi-fidelity evaluation combining Hyperband scheduling with Bayesian Optimization proposals.
                    </p>

                    <div class="math-block">
                        $$r = \frac{n_{\text{valid}}}{b_{\min}}, \quad s_{\max} = \lfloor \frac{\log r}{\log \eta} \rfloor$$
                    </div>

                    <table style="margin-top: 1rem;">
                        <tr>
                            <td><code>bmin</code></td>
                            <td style="color: var(--accent-cyan);">10</td>
                            <td>Minimum fidelity (samples)</td>
                        </tr>
                        <tr>
                            <td><code>Œ∑</code></td>
                            <td style="color: var(--accent-purple);">2.0</td>
                            <td>Downsampling rate</td>
                        </tr>
                        <tr>
                            <td><code>max fidelity</code></td>
                            <td style="color: var(--accent-green);">1319</td>
                            <td>Full validation set</td>
                        </tr>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 300px;">
                        <svg viewBox="0 0 400 280" xmlns="http://www.w3.org/2000/svg">
                            <!-- Successive halving visualization -->
                            <text x="200" y="25" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">Successive Halving Schedule</text>

                            <!-- Stage 0 -->
                            <rect x="30" y="50" width="340" height="35" rx="4" fill="rgba(63,185,80,0.2)" stroke="#3fb950"/>
                            <text x="50" y="73" fill="#3fb950" font-size="11" font-family="Outfit">Stage 0: n instructions @ 10 samples</text>

                            <!-- Stage 1 -->
                            <rect x="60" y="95" width="280" height="35" rx="4" fill="rgba(63,185,80,0.3)" stroke="#3fb950"/>
                            <text x="80" y="118" fill="#3fb950" font-size="11" font-family="Outfit">Stage 1: n/2 instructions @ 20 samples</text>

                            <!-- Stage 2 -->
                            <rect x="90" y="140" width="220" height="35" rx="4" fill="rgba(63,185,80,0.4)" stroke="#3fb950"/>
                            <text x="110" y="163" fill="#3fb950" font-size="11" font-family="Outfit">Stage 2: n/4 @ 40 samples</text>

                            <!-- Stage 3 -->
                            <rect x="120" y="185" width="160" height="35" rx="4" fill="rgba(63,185,80,0.6)" stroke="#3fb950"/>
                            <text x="140" y="208" fill="#e6edf3" font-size="11" font-family="Outfit">... ‚Üí full fidelity</text>

                            <!-- Keep top arrow -->
                            <text x="200" y="250" text-anchor="middle" fill="#d29922" font-size="11" font-family="Outfit">Keep top performers at each stage</text>
                        </svg>
                    </div>

                    <div class="highlight-box highlight-green" style="margin-top: 1rem;">
                        <strong>BO Proposals:</strong> 90% Expected Improvement, 10% Random exploration
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 14: Hyperband GP    -->
        <!-- ========================= -->
        <section class="slide" data-slide="14">
            <span class="section-badge fade-in">Phase 3: Multi-Fidelity Optimization</span>
            <h2 class="fade-in fade-in-delay-1">GP Training in Hyperband</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>High-Fidelity Training Data</h3>
                    <p style="margin-bottom: 1.5rem;">
                        GP is trained only on high-fidelity evaluations to prevent bias from unreliable low-fidelity estimates.
                    </p>

                    <div class="card card-glow">
                        <div class="code-block">
<span class="comment"># Filter training data</span>
<span class="function">min_fidelity_pct</span> = <span class="number">0.75</span>
<span class="function">threshold</span> = max_fidelity * min_fidelity_pct

<span class="comment"># Only use fidelity >= 75% of full</span>
high_fidelity_mask = fidelity >= threshold
X_train = embeddings[high_fidelity_mask]
y_train = error_rates[high_fidelity_mask]
                        </div>
                    </div>

                    <div class="highlight-box highlight-purple" style="margin-top: 1.5rem;">
                        <strong>Why 75%?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Top 25% fidelity data provides reliable signal without discarding too much information.
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Hyperband GP Parameters</h3>
                    <table>
                        <tr>
                            <td><code>epochs</code></td>
                            <td style="color: var(--accent-cyan);">3000</td>
                            <td>Reduced for speed</td>
                        </tr>
                        <tr>
                            <td><code>lr</code></td>
                            <td style="color: var(--accent-purple);">0.01</td>
                            <td>Learning rate</td>
                        </tr>
                        <tr>
                            <td><code>patience</code></td>
                            <td style="color: var(--accent-green);">50</td>
                            <td>Early stopping</td>
                        </tr>
                    </table>

                    <div class="card" style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-orange); margin-bottom: 0.75rem;">Evaluation Caching</h4>
                        <div class="code-block" style="font-size: 0.85rem;">
<span class="comment"># Cache key: (instruction_id, fidelity)</span>
<span class="comment"># Extension from lower fidelity:</span>
total_err = (prev_err * prev_f +
             new_err * (f - prev_f)) / f
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 15: GP Architecture -->
        <!-- ========================= -->
        <section class="slide" data-slide="15">
            <span class="section-badge fade-in">Phase 3: Multi-Fidelity Optimization</span>
            <h2 class="fade-in fade-in-delay-1">GP Architecture</h2>

            <div class="diagram-container fade-in fade-in-delay-2" style="flex: 1;">
                <svg viewBox="0 0 1100 420" xmlns="http://www.w3.org/2000/svg">
                    <!-- Title -->
                    <text x="550" y="30" text-anchor="middle" fill="#3fb950" font-size="16" font-weight="600" font-family="Outfit">InstructionDeepKernelGP: 32D ARD Mat√©rn 5/2</text>

                    <!-- Input -->
                    <rect x="50" y="80" width="150" height="100" rx="8" fill="rgba(0,217,255,0.2)" stroke="#00d9ff" stroke-width="2"/>
                    <text x="125" y="115" text-anchor="middle" fill="#00d9ff" font-size="14" font-weight="500" font-family="Outfit">768D Embedding</text>
                    <text x="125" y="150" text-anchor="middle" fill="#8b949e" font-size="11" font-family="Outfit">GTR output</text>

                    <!-- Arrow -->
                    <line x1="200" y1="130" x2="240" y2="130" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowheadCyan)"/>

                    <!-- VAE Encoder -->
                    <rect x="250" y="80" width="150" height="100" rx="8" fill="rgba(163,113,247,0.3)" stroke="#a371f7" stroke-width="2"/>
                    <text x="325" y="115" text-anchor="middle" fill="#a371f7" font-size="14" font-weight="500" font-family="Outfit">VAE Encoder</text>
                    <text x="325" y="135" text-anchor="middle" fill="#8b949e" font-size="11" font-family="JetBrains Mono">768 ‚Üí 32</text>
                    <text x="325" y="155" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">(frozen)</text>

                    <!-- Arrow -->
                    <line x1="400" y1="130" x2="440" y2="130" stroke="#a371f7" stroke-width="2"/>

                    <!-- Unit Cube Norm -->
                    <rect x="450" y="80" width="150" height="100" rx="8" fill="rgba(210,153,34,0.2)" stroke="#d29922" stroke-width="2"/>
                    <text x="525" y="110" text-anchor="middle" fill="#d29922" font-size="14" font-weight="500" font-family="Outfit">Unit Cube</text>
                    <text x="525" y="130" text-anchor="middle" fill="#d29922" font-size="14" font-weight="500" font-family="Outfit">Normalization</text>
                    <text x="525" y="155" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">(z - min)/(max - min)</text>

                    <!-- Arrow -->
                    <line x1="600" y1="130" x2="640" y2="130" stroke="#d29922" stroke-width="2"/>

                    <!-- GP Model Box -->
                    <rect x="650" y="50" width="400" height="240" rx="10" fill="#161b22" stroke="#3fb950" stroke-width="2"/>
                    <text x="850" y="80" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="600" font-family="Outfit">InstructionDeepKernelGP</text>

                    <!-- Mean Module -->
                    <rect x="680" y="100" width="150" height="50" rx="6" fill="rgba(63,185,80,0.2)" stroke="#3fb950"/>
                    <text x="755" y="125" text-anchor="middle" fill="#3fb950" font-size="12" font-family="Outfit">ZeroMean()</text>
                    <text x="755" y="142" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">Œº(x) = 0</text>

                    <!-- Covariance Module -->
                    <rect x="680" y="165" width="340" height="110" rx="6" fill="rgba(63,185,80,0.2)" stroke="#3fb950"/>
                    <text x="850" y="190" text-anchor="middle" fill="#3fb950" font-size="12" font-weight="500" font-family="Outfit">ScaleKernel(MaternKernel())</text>

                    <!-- ARD highlight -->
                    <rect x="700" y="200" width="130" height="60" rx="4" fill="rgba(163,113,247,0.3)" stroke="#a371f7"/>
                    <text x="765" y="225" text-anchor="middle" fill="#a371f7" font-size="11" font-weight="600" font-family="Outfit">ARD = 32D</text>
                    <text x="765" y="245" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">32 lengthscales</text>

                    <!-- Matern -->
                    <rect x="850" y="200" width="150" height="60" rx="4" fill="rgba(63,185,80,0.3)" stroke="#3fb950"/>
                    <text x="925" y="225" text-anchor="middle" fill="#3fb950" font-size="11" font-weight="600" font-family="Outfit">Mat√©rn ŒΩ=5/2</text>
                    <text x="925" y="245" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">Twice differentiable</text>

                    <!-- Output -->
                    <rect x="780" y="320" width="200" height="70" rx="8" fill="rgba(63,185,80,0.3)" stroke="#3fb950" stroke-width="2"/>
                    <text x="880" y="350" text-anchor="middle" fill="#3fb950" font-size="14" font-weight="500" font-family="Outfit">MultivariateNormal</text>
                    <text x="880" y="375" text-anchor="middle" fill="#8b949e" font-size="11" font-family="JetBrains Mono">mean(z), cov(z)</text>

                    <!-- Arrow to output -->
                    <line x1="850" y1="290" x2="850" y2="320" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowhead)"/>

                    <!-- Legend -->
                    <g transform="translate(50, 320)">
                        <rect x="0" y="0" width="550" height="70" rx="6" fill="rgba(22,27,34,0.9)"/>
                        <text x="20" y="25" fill="#a371f7" font-size="12" font-weight="600" font-family="Outfit">ARD (Automatic Relevance Determination):</text>
                        <text x="20" y="50" fill="#8b949e" font-size="11" font-family="Outfit">Each of 32 latent dimensions has its own lengthscale ‚Äî GP learns importance automatically</text>
                    </g>
                </svg>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 16: Heteroscedastic Noise -->
        <!-- ========================= -->
        <section class="slide" data-slide="16">
            <span class="section-badge fade-in">Phase 3: Multi-Fidelity Optimization</span>
            <h2 class="fade-in fade-in-delay-1">Heteroscedastic Noise</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Bernoulli Variance</h3>
                    <p style="margin-bottom: 1.5rem;">
                        GP receives reliability information via observation-specific noise based on Bernoulli statistics.
                    </p>

                    <div class="math-block">
                        $$\text{Var}(p) = \frac{p(1-p)}{n}$$
                    </div>

                    <p style="margin-top: 1rem;">
                        where $p$ = error rate, $n$ = fidelity (samples)
                    </p>

                    <div class="highlight-box highlight-orange" style="margin-top: 1.5rem;">
                        <strong>Effect:</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Low fidelity ‚Üí high variance ‚Üí GP trusts less<br>
                            High fidelity ‚Üí low variance ‚Üí GP trusts more
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Example: error_rate = 0.20</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Fidelity</th>
                                <th>Variance</th>
                                <th>Trust Level</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>n=10</code></td>
                                <td style="color: var(--accent-red);">0.016</td>
                                <td>LOW</td>
                            </tr>
                            <tr>
                                <td><code>n=100</code></td>
                                <td style="color: var(--accent-orange);">0.0016</td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><code>n=1319</code></td>
                                <td style="color: var(--accent-green);">0.00012</td>
                                <td>HIGH</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="card" style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-cyan); margin-bottom: 0.75rem;">Implementation</h4>
                        <div class="code-block" style="font-size: 0.9rem;">
<span class="function">FixedNoiseGaussianLikelihood</span>(
    noise=variance,
    <span class="function">learn_additional_noise</span>=<span class="keyword">False</span>
)
<span class="comment"># False for CUDA stability</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 17: GP Negation     -->
        <!-- ========================= -->
        <section class="slide" data-slide="17">
            <span class="section-badge fade-in">Phase 3: Multi-Fidelity Optimization</span>
            <h2 class="fade-in fade-in-delay-1">Error Rate Negation for BoTorch</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>The Problem</h3>
                    <p style="margin-bottom: 1.5rem;">
                        BoTorch's <code>qLogExpectedImprovement</code> <strong>MAXIMIZES</strong> by default. We want to <strong>minimize</strong> error rate.
                    </p>

                    <div class="card card-glow">
                        <h4 style="color: var(--accent-purple); margin-bottom: 0.75rem;">Solution: Negate</h4>
                        <div class="code-block">
<span class="comment"># Store negated values for GP</span>
y_train = -error_rates

<span class="comment"># Best = max of negated = min of original</span>
y_best = y_train.max()  <span class="comment"># = -min(error)</span>
                        </div>
                    </div>

                    <div class="highlight-box highlight-green" style="margin-top: 1.5rem;">
                        <strong>At prediction:</strong> Negate back to positive error rate
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Example</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Instruction</th>
                                <th>error_rate</th>
                                <th>y_train</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>A</td>
                                <td>0.10</td>
                                <td style="color: var(--accent-purple);">-0.10</td>
                            </tr>
                            <tr>
                                <td>B</td>
                                <td>0.25</td>
                                <td style="color: var(--accent-purple);">-0.25</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-green);">C ‚≠ê</td>
                                <td style="color: var(--accent-green);">0.05</td>
                                <td style="color: var(--accent-green);">-0.05</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="math-block" style="margin-top: 1.5rem;">
                        $$y_{\text{best}} = \max(-0.10, -0.25, -0.05) = -0.05$$
                    </div>

                    <p style="margin-top: 1rem; font-size: 1rem; color: var(--text-secondary);">
                        EI seeks points where GP predicts values &gt; -0.05<br>
                        (i.e., error &lt; 0.05)
                    </p>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 18: InvBO Overview  -->
        <!-- ========================= -->
        <section class="slide" data-slide="18">
            <span class="section-badge fade-in">Phase 4: InvBO Loop</span>
            <h2 class="fade-in fade-in-delay-1">InvBO: Inversion Bayesian Optimization</h2>

            <div class="content-full" style="justify-content: center;">
                <p class="fade-in fade-in-delay-2" style="text-align: center; margin-bottom: 2rem;">
                    Iterative optimization in VAE latent space with text inversion
                </p>

                <div class="diagram-container fade-in fade-in-delay-3" style="height: 350px;">
                    <svg viewBox="0 0 1000 320" xmlns="http://www.w3.org/2000/svg">
                        <!-- Main loop -->
                        <rect x="30" y="30" width="940" height="250" rx="12" fill="rgba(210,153,34,0.1)" stroke="#d29922" stroke-width="2" stroke-dasharray="8,4"/>
                        <text x="500" y="20" text-anchor="middle" fill="#d29922" font-size="14" font-weight="600" font-family="Outfit">InvBO OPTIMIZATION LOOP</text>

                        <!-- Step 1: TuRBO -->
                        <rect x="60" y="70" width="180" height="80" rx="8" fill="rgba(210,153,34,0.3)" stroke="#d29922" stroke-width="2"/>
                        <text x="150" y="100" text-anchor="middle" fill="#d29922" font-size="13" font-weight="600" font-family="Outfit">TuRBO</text>
                        <text x="150" y="120" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">Trust Region</text>
                        <text x="150" y="138" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">L: 0.4 ‚Üí 0.8</text>

                        <!-- Arrow -->
                        <line x1="240" y1="110" x2="270" y2="110" stroke="#d29922" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Step 2: PAS -->
                        <rect x="280" y="70" width="180" height="80" rx="8" fill="rgba(247,120,186,0.3)" stroke="#f778ba" stroke-width="2"/>
                        <text x="370" y="100" text-anchor="middle" fill="#f778ba" font-size="13" font-weight="600" font-family="Outfit">PAS</text>
                        <text x="370" y="120" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">Anchor Selection</text>
                        <text x="370" y="138" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">Thompson Sampling</text>

                        <!-- Arrow -->
                        <line x1="460" y1="110" x2="490" y2="110" stroke="#f778ba" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Step 3: BoTorch -->
                        <rect x="500" y="70" width="180" height="80" rx="8" fill="rgba(88,166,255,0.3)" stroke="#58a6ff" stroke-width="2"/>
                        <text x="590" y="100" text-anchor="middle" fill="#58a6ff" font-size="13" font-weight="600" font-family="Outfit">BoTorch qLogEI</text>
                        <text x="590" y="120" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">Acquisition Optimization</text>
                        <text x="590" y="138" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">64 restarts</text>

                        <!-- Arrow -->
                        <line x1="680" y1="110" x2="710" y2="110" stroke="#58a6ff" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Step 4: Vec2Text -->
                        <rect x="720" y="70" width="180" height="80" rx="8" fill="rgba(163,113,247,0.3)" stroke="#a371f7" stroke-width="2"/>
                        <text x="810" y="100" text-anchor="middle" fill="#a371f7" font-size="13" font-weight="600" font-family="Outfit">Vec2Text</text>
                        <text x="810" y="120" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">+ ZSInvert Refinement</text>
                        <text x="810" y="138" text-anchor="middle" fill="#8b949e" font-size="9" font-family="JetBrains Mono">32D ‚Üí text</text>

                        <!-- Bottom row: Evaluate & Update -->
                        <rect x="280" y="180" width="200" height="70" rx="8" fill="rgba(63,185,80,0.3)" stroke="#3fb950" stroke-width="2"/>
                        <text x="380" y="210" text-anchor="middle" fill="#3fb950" font-size="13" font-weight="600" font-family="Outfit">LLM Evaluation</text>
                        <text x="380" y="232" text-anchor="middle" fill="#8b949e" font-size="10" font-family="Outfit">GSM8K validation</text>

                        <rect x="520" y="180" width="200" height="70" rx="8" fill="rgba(63,185,80,0.3)" stroke="#3fb950" stroke-width="2"/>
                        <text x="620" y="210" text-anchor="middle" fill="#3fb950" font-size="13" font-weight="600" font-family="Outfit">GP Retrain</text>
                        <text x="620" y="232" text-anchor="middle" fill="#8b949e" font-size="10" font-family="JetBrains Mono">1000 epochs</text>

                        <!-- Arrows -->
                        <path d="M 810 150 L 810 215 L 720 215" fill="none" stroke="#a371f7" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <line x1="480" y1="215" x2="520" y2="215" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowhead)"/>

                        <!-- Loop back arrow -->
                        <path d="M 720 215 Q 760 280 150 280 Q 60 280 60 150 L 60 130" fill="none" stroke="#d29922" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrowhead)"/>
                        <text x="400" y="295" text-anchor="middle" fill="#d29922" font-size="11" font-family="Outfit">Repeat for N iterations</text>
                    </svg>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 19: TuRBO           -->
        <!-- ========================= -->
        <section class="slide" data-slide="19">
            <span class="section-badge fade-in">Phase 4: InvBO Loop</span>
            <h2 class="fade-in fade-in-delay-1">TuRBO: Trust Region BO</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>ARD-Aware Trust Regions</h3>
                    <p style="margin-bottom: 1.5rem;">
                        LOL-BO style scaling: trust region size adapts to ARD lengthscales per dimension.
                    </p>

                    <div class="math-block">
                        $$L_i^{\text{scaled}} = \frac{L}{2 \cdot \ell_i / \bar{\ell}}$$
                    </div>

                    <p style="margin-top: 1rem; font-size: 1rem; color: var(--text-secondary);">
                        Short lengthscale (important dim) ‚Üí narrower region<br>
                        Long lengthscale (irrelevant dim) ‚Üí wider region
                    </p>

                    <div class="highlight-box highlight-orange" style="margin-top: 1.5rem;">
                        <strong>Benefit:</strong> Better exploration in relevant dimensions
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>TuRBO Parameters</h3>
                    <table>
                        <tr>
                            <td><code>L_init</code></td>
                            <td style="color: var(--accent-orange);">0.4</td>
                            <td>Initial region size</td>
                        </tr>
                        <tr>
                            <td><code>L_max</code></td>
                            <td style="color: var(--accent-purple);">0.8</td>
                            <td>Maximum expansion</td>
                        </tr>
                        <tr>
                            <td><code>L_min</code></td>
                            <td style="color: var(--accent-cyan);">0.0078</td>
                            <td>Min before restart</td>
                        </tr>
                        <tr>
                            <td><code>œÑ_succ</code></td>
                            <td style="color: var(--accent-green);">3</td>
                            <td>Successes to expand</td>
                        </tr>
                        <tr>
                            <td><code>œÑ_fail</code></td>
                            <td style="color: var(--accent-red);">25</td>
                            <td>Failures to shrink</td>
                        </tr>
                    </table>

                    <div class="card" style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-green); margin-bottom: 0.5rem;">Adaptive Logic</h4>
                        <p style="font-size: 0.95rem;">
                            <strong>3 consecutive successes:</strong> L √ó 2<br>
                            <strong>25 consecutive failures:</strong> L / 2<br>
                            <strong>L &lt; L_min:</strong> Restart to best known point
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 20: PAS             -->
        <!-- ========================= -->
        <section class="slide" data-slide="20">
            <span class="section-badge fade-in">Phase 4: InvBO Loop</span>
            <h2 class="fade-in fade-in-delay-1">PAS: Potential-Aware Anchor Selection</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Thompson Sampling</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Selects the center of the trust region by Thompson Sampling from GP posterior.
                    </p>

                    <div class="card card-glow">
                        <div class="code-block">
<span class="comment"># Generate candidates from training data</span>
candidates = sample_near_best(n=<span class="number">100</span>)

<span class="comment"># Thompson Sampling: sample from posterior</span>
<span class="keyword">for</span> c <span class="keyword">in</span> candidates:
    posterior = GP.posterior(c)
    sample = posterior.rsample()  <span class="comment"># Random sample</span>

<span class="comment"># Select anchor with best sample</span>
anchor = candidates[argmax(samples)]
                        </div>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Why Thompson Sampling?</h3>
                    <ul class="feature-list">
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-purple);">üéØ</div>
                            <div>
                                <strong>Exploration-Exploitation Balance</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Naturally balances via randomness</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üìä</div>
                            <div>
                                <strong>Uncertainty-Aware</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">High uncertainty ‚Üí more likely to explore</p>
                            </div>
                        </li>
                    </ul>

                    <table style="margin-top: 1rem;">
                        <tr>
                            <td><code>n_candidates</code></td>
                            <td style="color: var(--accent-cyan);">100</td>
                            <td>Candidates per selection</td>
                        </tr>
                    </table>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 21: qLogEI          -->
        <!-- ========================= -->
        <section class="slide" data-slide="21">
            <span class="section-badge fade-in">Phase 4: InvBO Loop</span>
            <h2 class="fade-in fade-in-delay-1">BoTorch qLogEI Acquisition</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Log Expected Improvement</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Numerically stable EI computation from "Unexpected Improvements to Expected Improvement" (NeurIPS 2023).
                    </p>

                    <div class="math-block">
                        $$\text{LogEI} = \log h(z) + \log \sigma$$
                    </div>
                    <div class="math-block" style="margin-top: 0.5rem; font-size: 1rem;">
                        $$z = \frac{f_{\text{best}} - \mu - \xi}{\sigma}$$
                    </div>

                    <div class="highlight-box highlight-purple" style="margin-top: 1.5rem;">
                        <strong>Why Log scale?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Standard EI underflows to 0 for tiny improvements. LogEI maintains precision.
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Optimization Parameters</h3>
                    <table>
                        <tr>
                            <td><code>num_restarts</code></td>
                            <td style="color: var(--accent-cyan);">64</td>
                            <td>L-BFGS-B multi-starts</td>
                        </tr>
                        <tr>
                            <td><code>raw_samples</code></td>
                            <td style="color: var(--accent-purple);">1024</td>
                            <td>Initial seeding</td>
                        </tr>
                        <tr>
                            <td><code>maxiter</code></td>
                            <td style="color: var(--accent-green);">200</td>
                            <td>L-BFGS-B iterations</td>
                        </tr>
                    </table>

                    <div class="card" style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-orange); margin-bottom: 0.75rem;">Bounds Expansion</h4>
                        <div class="code-block" style="font-size: 0.9rem;">
<span class="comment"># 20% margin beyond training data</span>
<span class="function">latent_margin</span> = <span class="number">0.2</span>
bounds = [z_min - margin*range,
          z_max + margin*range]
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 22: LogEI Details   -->
        <!-- ========================= -->
        <section class="slide" data-slide="22">
            <span class="section-badge fade-in">Phase 4: InvBO Loop</span>
            <h2 class="fade-in fade-in-delay-1">LogEI: Three-Branch Implementation</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Numerical Stability</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Three computation branches based on z-score for maximum precision:
                    </p>

                    <div class="card" style="margin-bottom: 1rem;">
                        <h4 style="color: var(--accent-green);">Branch 1: z &gt; -1</h4>
                        <div class="code-block" style="font-size: 0.9rem;">
<span class="comment"># Direct computation</span>
h = œÜ(z) + z¬∑Œ¶(z)
<span class="keyword">return</span> log(h)
                        </div>
                    </div>

                    <div class="card" style="margin-bottom: 1rem;">
                        <h4 style="color: var(--accent-cyan);">Branch 2: -1/‚àöŒµ &lt; z ‚â§ -1</h4>
                        <div class="code-block" style="font-size: 0.9rem;">
<span class="comment"># erfcx-based computation</span>
<span class="keyword">return</span> -z¬≤/2 - C‚ÇÅ + log1mexp(...)
                        </div>
                    </div>

                    <div class="card">
                        <h4 style="color: var(--accent-purple);">Branch 3: z ‚â§ -1/‚àöŒµ</h4>
                        <div class="code-block" style="font-size: 0.9rem;">
<span class="comment"># Asymptotic approximation</span>
<span class="keyword">return</span> -z¬≤/2 - C‚ÇÅ - 2¬∑log|z|
                        </div>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 350px;">
                        <svg viewBox="0 0 400 320" xmlns="http://www.w3.org/2000/svg">
                            <!-- Axes -->
                            <line x1="50" y1="250" x2="380" y2="250" stroke="#6e7681" stroke-width="2"/>
                            <line x1="200" y1="280" x2="200" y2="30" stroke="#6e7681" stroke-width="2"/>

                            <text x="200" y="300" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit">z</text>
                            <text x="35" y="140" text-anchor="middle" fill="#8b949e" font-size="12" font-family="Outfit" transform="rotate(-90, 35, 140)">log h(z)</text>

                            <!-- Branch regions -->
                            <rect x="200" y="30" width="180" height="220" fill="rgba(63,185,80,0.1)"/>
                            <rect x="100" y="30" width="100" height="220" fill="rgba(0,217,255,0.1)"/>
                            <rect x="50" y="30" width="50" height="220" fill="rgba(163,113,247,0.1)"/>

                            <!-- Curve -->
                            <path d="M 50 80 Q 100 100 150 140 Q 180 170 200 200 Q 250 230 350 245" fill="none" stroke="#d29922" stroke-width="3"/>

                            <!-- Branch labels -->
                            <text x="290" y="50" text-anchor="middle" fill="#3fb950" font-size="10" font-family="Outfit">Direct</text>
                            <text x="150" y="50" text-anchor="middle" fill="#00d9ff" font-size="10" font-family="Outfit">erfcx</text>
                            <text x="75" y="50" text-anchor="middle" fill="#a371f7" font-size="10" font-family="Outfit">Asymp.</text>

                            <!-- Critical points -->
                            <circle cx="200" cy="200" r="4" fill="#d29922"/>
                            <text x="215" y="195" fill="#8b949e" font-size="10" font-family="JetBrains Mono">z=-1</text>

                            <circle cx="100" cy="100" r="4" fill="#d29922"/>
                            <text x="85" y="95" fill="#8b949e" font-size="9" font-family="JetBrains Mono">z=-1/‚àöŒµ</text>
                        </svg>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 23: Candidate Rejection -->
        <!-- ========================= -->
        <section class="slide" data-slide="23">
            <span class="section-badge fade-in">Phase 4: InvBO Loop</span>
            <h2 class="fade-in fade-in-delay-1">Candidate Rejection Loop</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Quality Assurance</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Ensures generated text faithfully represents the optimized latent point.
                    </p>

                    <div class="code-block">
<span class="keyword">for</span> attempt <span class="keyword">in</span> range(max_attempts):
    z_opt = optimize_latent(seed=iter*5+attempt)
    emb = VAE.decode(z_opt)
    text = Vec2Text.invert(emb)

    reencoded = GTR.encode(text)
    cosine = similarity(emb, reencoded)

    <span class="keyword">if</span> cosine >= <span class="number">0.93</span>:
        <span class="keyword">break</span>  <span class="comment"># Good candidate</span>

<span class="keyword">if</span> attempt == max_attempts - 1:
    log(<span class="string">"WARNING: Low quality"</span>)
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Parameters</h3>
                    <table>
                        <tr>
                            <td><code>cosine_threshold</code></td>
                            <td style="color: var(--accent-green);">0.93</td>
                            <td>Acceptance threshold</td>
                        </tr>
                        <tr>
                            <td><code>max_attempts</code></td>
                            <td style="color: var(--accent-orange);">10</td>
                            <td>Retry limit</td>
                        </tr>
                    </table>

                    <div class="highlight-box highlight-orange" style="margin-top: 1.5rem;">
                        <strong>Why check?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Vec2Text may generate text far from decoder output. Without verification, optimization would be misguided.
                        </p>
                    </div>

                    <div class="card" style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-red);">Fallback Behavior</h4>
                        <p style="font-size: 0.95rem;">
                            After 10 failed attempts, accept the best candidate with a warning. Indicates Vec2Text limitations.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 24: Vec2Text        -->
        <!-- ========================= -->
        <section class="slide" data-slide="24">
            <span class="section-badge fade-in">Inversion</span>
            <h2 class="fade-in fade-in-delay-1">Vec2Text Inversion</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Embedding ‚Üí Text</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Converts GTR embeddings back to natural language using a trained inversion model.
                    </p>

                    <div class="arch-box arch-box-purple">
                        <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                        <span>‚Üí VAE Decoder ‚Üí</span>
                        <span class="dim-badge">768D</span>
                    </div>
                    <div class="arrow-down" style="color: var(--accent-purple);">‚Üì</div>
                    <div class="arch-box arch-box-cyan">
                        <span class="dim-badge">768D</span>
                        <span>‚Üí Vec2Text ‚Üí</span>
                        <span class="dim-badge" style="border-color: var(--accent-green); color: var(--accent-green);">Text</span>
                    </div>

                    <div class="highlight-box highlight-cyan" style="margin-top: 1.5rem;">
                        <strong>Model:</strong> <code>512_tokens</code><br>
                        <strong>Max length:</strong> 128 tokens<br>
                        <strong>Beam width:</strong> 8
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Generation Settings</h3>
                    <div class="card card-glow">
                        <div class="code-block">
<span class="function">gen_kwargs</span> = {
    <span class="string">"num_beams"</span>: <span class="number">8</span>,
    <span class="string">"max_length"</span>: <span class="number">128</span>,
    <span class="string">"no_repeat_ngram_size"</span>: <span class="number">3</span>,
    <span class="string">"repetition_penalty"</span>: <span class="number">1.2</span>,
}
                        </div>
                    </div>

                    <div class="card" style="margin-top: 1.5rem;">
                        <h4 style="color: var(--accent-orange); margin-bottom: 0.75rem;">Typical Round-Trip Quality</h4>
                        <p style="font-size: 1rem;">
                            Vec2Text alone: ~0.85 cosine similarity<br>
                            <strong>With ZSInvert:</strong> ~0.90+ cosine similarity
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 25: ZSInvert        -->
        <!-- ========================= -->
        <section class="slide" data-slide="25">
            <span class="section-badge fade-in">Inversion</span>
            <h2 class="fade-in fade-in-delay-1">ZSInvert Refinement</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Fixed-Target Iterative Refinement</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Iteratively improves Vec2Text output by aligning to a fixed target embedding.
                    </p>

                    <div class="code-block">
<span class="comment"># Fixed target - never changes!</span>
fixed_target = VAE.decode(initial_z)

<span class="keyword">for</span> iter <span class="keyword">in</span> range(n_iterations):
    <span class="comment"># Gradient descent</span>
    z_opt = optimize(z, target=GTR(best_text))

    <span class="comment"># Re-decode and invert</span>
    new_emb = VAE.decode(z_opt)
    new_text = Vec2Text.invert(new_emb)

    <span class="comment"># Measure against FIXED target</span>
    sim = cosine(GTR(new_text), fixed_target)

    <span class="keyword">if</span> sim > best_sim:
        best_text = new_text
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Parameters</h3>
                    <table>
                        <tr>
                            <td><code>iterations</code></td>
                            <td style="color: var(--accent-cyan);">25</td>
                            <td>Max iterations</td>
                        </tr>
                        <tr>
                            <td><code>lr</code></td>
                            <td style="color: var(--accent-purple);">0.1</td>
                            <td>Gradient LR</td>
                        </tr>
                        <tr>
                            <td><code>steps_per_iter</code></td>
                            <td style="color: var(--accent-green);">50</td>
                            <td>Opt steps</td>
                        </tr>
                        <tr>
                            <td><code>patience</code></td>
                            <td style="color: var(--accent-orange);">8</td>
                            <td>Early stop</td>
                        </tr>
                    </table>

                    <div class="highlight-box highlight-green" style="margin-top: 1.5rem;">
                        <strong>Why fixed target?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Moving target ‚Üí "jumping" similarity values<br>
                            Fixed target ‚Üí consistent progress tracking
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 26: Inversion Loop  -->
        <!-- ========================= -->
        <section class="slide" data-slide="26">
            <span class="section-badge fade-in">Inversion</span>
            <h2 class="fade-in fade-in-delay-1">InvBO Inversion Loop</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Closing the Gap</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Problem: VAE decoder output ‚â† GTR(Vec2Text(embedding))
                    </p>
                    <p style="margin-bottom: 1.5rem;">
                        Solution: Find z<sub>inv</sub> where decoder(z<sub>inv</sub>) ‚âà GTR(text)
                    </p>

                    <div class="math-block">
                        $$z_{\text{inv}} = \arg\min_z \| \text{decode}(z) - \text{GTR}(\text{text}) \|$$
                    </div>

                    <table style="margin-top: 1.5rem;">
                        <tr>
                            <td><code>max_iters</code></td>
                            <td style="color: var(--accent-cyan);">3</td>
                        </tr>
                        <tr>
                            <td><code>gap_threshold</code></td>
                            <td style="color: var(--accent-orange);">0.08</td>
                        </tr>
                        <tr>
                            <td><code>Adam steps</code></td>
                            <td style="color: var(--accent-green);">100</td>
                        </tr>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 350px;">
                        <svg viewBox="0 0 400 320" xmlns="http://www.w3.org/2000/svg">
                            <!-- Loop visualization -->
                            <text x="200" y="25" text-anchor="middle" fill="#d29922" font-size="14" font-weight="600" font-family="Outfit">Inversion Loop</text>

                            <!-- z_opt -->
                            <rect x="150" y="50" width="100" height="50" rx="6" fill="rgba(163,113,247,0.3)" stroke="#a371f7"/>
                            <text x="200" y="80" text-anchor="middle" fill="#a371f7" font-size="12" font-family="Outfit">z_opt (32D)</text>

                            <!-- Decode -->
                            <line x1="200" y1="100" x2="200" y2="120" stroke="#a371f7" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <rect x="130" y="125" width="140" height="40" rx="6" fill="rgba(0,217,255,0.2)" stroke="#00d9ff"/>
                            <text x="200" y="150" text-anchor="middle" fill="#00d9ff" font-size="11" font-family="Outfit">VAE.decode ‚Üí 768D</text>

                            <!-- Vec2Text -->
                            <line x1="200" y1="165" x2="200" y2="185" stroke="#00d9ff" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <rect x="130" y="190" width="140" height="40" rx="6" fill="rgba(63,185,80,0.2)" stroke="#3fb950"/>
                            <text x="200" y="215" text-anchor="middle" fill="#3fb950" font-size="11" font-family="Outfit">Vec2Text ‚Üí text</text>

                            <!-- Re-encode -->
                            <line x1="200" y1="230" x2="200" y2="250" stroke="#3fb950" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <rect x="130" y="255" width="140" height="40" rx="6" fill="rgba(0,217,255,0.2)" stroke="#00d9ff"/>
                            <text x="200" y="280" text-anchor="middle" fill="#00d9ff" font-size="11" font-family="Outfit">GTR.encode ‚Üí 768D</text>

                            <!-- Gap check -->
                            <rect x="290" y="170" width="80" height="70" rx="6" fill="rgba(210,153,34,0.2)" stroke="#d29922"/>
                            <text x="330" y="195" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">Gap</text>
                            <text x="330" y="215" text-anchor="middle" fill="#d29922" font-size="10" font-family="Outfit">&lt; 0.08?</text>
                            <text x="330" y="232" text-anchor="middle" fill="#3fb950" font-size="9" font-family="Outfit">‚úì Done</text>

                            <!-- Loop arrow -->
                            <path d="M 270 255 Q 350 255 350 150 Q 350 75 250 75" fill="none" stroke="#d29922" stroke-width="2" stroke-dasharray="4,2" marker-end="url(#arrowhead)"/>
                            <text x="370" y="165" fill="#d29922" font-size="9" font-family="Outfit">Re-invert</text>
                        </svg>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 27: Quality KPIs    -->
        <!-- ========================= -->
        <section class="slide" data-slide="27">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">Quality KPIs Overview</h2>

            <div class="content-full" style="justify-content: center;">
                <div class="two-col" style="margin-bottom: 2rem;">
                    <div class="fade-in fade-in-delay-2">
                        <div class="card" style="border-left: 3px solid var(--accent-purple);">
                            <h3 style="color: var(--accent-purple);">Q<sub>VAE</sub>: VAE Quality</h3>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                Reconstruction quality with percentile analysis
                            </p>
                            <div style="margin-top: 1rem;">
                                <strong>Target:</strong> Q<sub>10</sub> &gt; 0.90
                            </div>
                        </div>
                    </div>

                    <div class="fade-in fade-in-delay-3">
                        <div class="card" style="border-left: 3px solid var(--accent-green);">
                            <h3 style="color: var(--accent-green);">Q<sub>GP</sub>: GP Predictive Power</h3>
                            <p style="margin-top: 0.5rem; font-size: 1rem;">
                                Spearman rank correlation: predicted vs actual
                            </p>
                            <div style="margin-top: 1rem;">
                                <strong>Target:</strong> œÅ &gt; 0.4
                            </div>
                        </div>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-4" style="max-width: 600px; margin: 0 auto;">
                    <div class="card" style="border-left: 3px solid var(--accent-orange);">
                        <h3 style="color: var(--accent-orange);">Q<sub>Sys</sub>: System Gap</h3>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Optimization gap between z_opt and z_real (after text generation)
                        </p>
                        <div style="margin-top: 1rem;">
                            <strong>Target:</strong> mean &lt; 0.5, max &lt; 1.0
                        </div>
                    </div>
                </div>

                <div class="highlight-box highlight-cyan fade-in fade-in-delay-5" style="margin-top: 2rem; text-align: center;">
                    <strong>All three metrics must be healthy for effective optimization</strong>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 28: VAE Quality     -->
        <!-- ========================= -->
        <section class="slide" data-slide="28">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">VAE Quality (Q<sub>VAE</sub>)</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Percentile Analysis</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Round-trip reconstruction: text ‚Üí GTR ‚Üí VAE ‚Üí cosine similarity
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Good</th>
                                <th>Acceptable</th>
                                <th>Poor</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Q<sub>10</sub></td>
                                <td style="color: var(--accent-green);">&gt; 0.92</td>
                                <td style="color: var(--accent-orange);">&gt; 0.90</td>
                                <td style="color: var(--accent-red);">‚â§ 0.90</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="highlight-box highlight-purple" style="margin-top: 1.5rem;">
                        <strong>Why Q<sub>10</sub>?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            10th percentile catches worst-case reconstructions. Mean alone hides outliers.
                        </p>
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>What it Catches</h3>
                    <ul class="feature-list">
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-red);">‚ö†Ô∏è</div>
                            <div>
                                <strong>Posterior collapse</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">All z map to same point</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-orange);">üï≥Ô∏è</div>
                            <div>
                                <strong>Latent space holes</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Some regions poorly decoded</p>
                            </div>
                        </li>
                        <li>
                            <div class="feature-icon" style="background: var(--gradient-cyan);">üìâ</div>
                            <div>
                                <strong>Mode dropping</strong>
                                <p style="margin-top: 0.3rem; font-size: 0.95rem;">Styles poorly represented</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 29: GP Quality      -->
        <!-- ========================= -->
        <section class="slide" data-slide="29">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">GP Predictive Power (Q<sub>GP</sub>)</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Spearman Rank Correlation</h3>
                    <div class="math-block">
                        $$\rho = 1 - \frac{6 \sum d_i^2}{n(n^2-1)}$$
                    </div>

                    <p style="margin-top: 1rem;">
                        Measures rank-order consistency between GP predictions and actual errors during inference.
                    </p>

                    <table style="margin-top: 1.5rem;">
                        <thead>
                            <tr>
                                <th>œÅ</th>
                                <th>Quality</th>
                                <th>Interpretation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="color: var(--accent-green);">&gt; 0.4</td>
                                <td>Good</td>
                                <td>Meaningful guidance</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-orange);">&gt; 0.2</td>
                                <td>Poor</td>
                                <td>Some signal</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-red);">‚â§ 0.2</td>
                                <td>Random</td>
                                <td>No predictive value</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Measurement</h3>
                    <div class="card card-glow">
                        <div class="code-block">
<span class="comment"># During inference iterations</span>
predicted = GP.predict(embedding)
actual = LLM.evaluate(text)

<span class="comment"># Compute Spearman over all iterations</span>
rho = spearman_correlation(
    predicted_errors,
    actual_errors
)
                        </div>
                    </div>

                    <div class="highlight-box highlight-green" style="margin-top: 1.5rem;">
                        <strong>Why rank correlation?</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            We need GP to correctly rank prompts, not predict exact values. EI only needs relative ordering.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 30: System Gap      -->
        <!-- ========================= -->
        <section class="slide" data-slide="30">
            <span class="section-badge fade-in">Quality Metrics</span>
            <h2 class="fade-in fade-in-delay-1">System Gap (Q<sub>Sys</sub>)</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Optimization Gap</h3>
                    <p style="margin-bottom: 1.5rem;">
                        Measures distance between intended latent z_opt and realized z_real (after text generation).
                    </p>

                    <div class="math-block">
                        $$\text{gap} = \| z_{\text{opt}} - z_{\text{real}} \|_2$$
                    </div>

                    <p style="margin-top: 1rem; font-size: 1rem;">
                        where z_real = VAE.encode(GTR(generated_text))
                    </p>

                    <table style="margin-top: 1.5rem;">
                        <thead>
                            <tr>
                                <th>Mean Gap</th>
                                <th>Quality</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="color: var(--accent-green);">&lt; 0.5</td>
                                <td>Good</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-orange);">&lt; 1.0</td>
                                <td>Acceptable</td>
                            </tr>
                            <tr>
                                <td style="color: var(--accent-red);">‚â• 1.0</td>
                                <td>Poor</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <div class="diagram-container" style="height: 280px;">
                        <svg viewBox="0 0 400 250" xmlns="http://www.w3.org/2000/svg">
                            <!-- Latent space visualization -->
                            <ellipse cx="200" cy="125" rx="180" ry="100" fill="none" stroke="#6e7681" stroke-width="1" stroke-dasharray="4,4"/>
                            <text x="200" y="235" text-anchor="middle" fill="#6e7681" font-size="11" font-family="Outfit">32D Latent Space</text>

                            <!-- z_opt -->
                            <circle cx="150" cy="100" r="10" fill="#d29922"/>
                            <text x="150" y="75" text-anchor="middle" fill="#d29922" font-size="11" font-family="Outfit">z_opt</text>
                            <text x="150" y="130" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">(optimized)</text>

                            <!-- z_real -->
                            <circle cx="250" cy="140" r="10" fill="#3fb950"/>
                            <text x="250" y="115" text-anchor="middle" fill="#3fb950" font-size="11" font-family="Outfit">z_real</text>
                            <text x="250" y="170" text-anchor="middle" fill="#8b949e" font-size="9" font-family="Outfit">(realized)</text>

                            <!-- Gap line -->
                            <line x1="160" y1="100" x2="240" y2="140" stroke="#f85149" stroke-width="2" stroke-dasharray="6,3"/>
                            <text x="200" y="108" text-anchor="middle" fill="#f85149" font-size="10" font-family="Outfit">gap</text>

                            <!-- Process arrow -->
                            <path d="M 160 105 Q 200 160 240 135" fill="none" stroke="#a371f7" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="230" y="185" text-anchor="middle" fill="#a371f7" font-size="9" font-family="Outfit">decode ‚Üí Vec2Text ‚Üí GTR ‚Üí encode</text>
                        </svg>
                    </div>

                    <div class="highlight-box highlight-orange" style="margin-top: 1rem;">
                        <strong>Large gap indicates:</strong>
                        <p style="margin-top: 0.5rem; font-size: 1rem;">
                            Vec2Text distortion or VAE decoder issues. Optimization is searching wrong regions.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 31: Iteration Summary -->
        <!-- ========================= -->
        <section class="slide" data-slide="31">
            <span class="section-badge fade-in">Results</span>
            <h2 class="fade-in fade-in-delay-1">Iteration Summary Output</h2>

            <div class="content-full fade-in fade-in-delay-2" style="justify-content: center;">
                <div class="code-block" style="font-size: 0.8rem; max-height: 450px; overflow-y: auto;">
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
<span class="function">ITERATION 1 SUMMARY</span>
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
<span class="string">Instruction:</span> Let's think step by step...
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
<span class="keyword">PERFORMANCE METRICS:</span>
  Predicted Error:    <span class="number">0.1523</span> ¬± 0.0234
  Actual Error:       <span class="number">0.1489</span>
  Best Error So Far:  <span class="number">0.1489</span>
  Improved:           <span class="string">YES</span>
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
<span class="keyword">OPTIMIZATION GAP METRICS:</span>
  VAE Latent Cosine:  <span class="number">0.9234</span>
  VAE Latent L2:      <span class="number">0.4521</span>
  GP Space Cosine:    <span class="number">0.9456</span>
  Pred @ z_real:      <span class="number">0.1534</span>
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
<span class="keyword">GENERATION QUALITY:</span>
  Cosine Similarity:  <span class="number">0.9512</span>
  LogEI:              <span class="number">-2.3456</span>
  Gap (inversion):    <span class="number">0.0489</span>
  Inversion Iters:    <span class="number">2</span>
  Rejection Attempts: <span class="number">0</span>
  Low Quality Accept: <span class="string">False</span>
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
<span class="keyword">GP Status:</span>
  Training Samples:   <span class="number">226</span>
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 32: Design Decisions -->
        <!-- ========================= -->
        <section class="slide" data-slide="32">
            <span class="section-badge fade-in">Summary</span>
            <h2 class="fade-in fade-in-delay-1">Key Design Decisions</h2>

            <div class="content-full" style="justify-content: center;">
                <div class="two-col">
                    <div class="fade-in fade-in-delay-2">
                        <ul class="feature-list" style="font-size: 0.95rem;">
                            <li>
                                <div class="feature-icon" style="background: var(--gradient-purple); font-size: 1rem;">32</div>
                                <div>
                                    <strong>32D VAE Latent</strong>
                                    <p style="font-size: 0.9rem;">24√ó compression, ARD learns importance</p>
                                </div>
                            </li>
                            <li>
                                <div class="feature-icon" style="background: var(--gradient-green); font-size: 1rem;">œÅ</div>
                                <div>
                                    <strong>No Adapter</strong>
                                    <p style="font-size: 0.9rem;">GP ARD on 32D is sufficient</p>
                                </div>
                            </li>
                            <li>
                                <div class="feature-icon" style="background: var(--gradient-orange); font-size: 1rem;">Œ≤</div>
                                <div>
                                    <strong>KL Annealing</strong>
                                    <p style="font-size: 0.9rem;">Prevents posterior collapse</p>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <div class="fade-in fade-in-delay-3">
                        <ul class="feature-list" style="font-size: 0.95rem;">
                            <li>
                                <div class="feature-icon" style="background: var(--gradient-cyan); font-size: 1rem;">‚àí</div>
                                <div>
                                    <strong>Negated Error Rates</strong>
                                    <p style="font-size: 0.9rem;">BoTorch maximizes ‚Üí negate for min</p>
                                </div>
                            </li>
                            <li>
                                <div class="feature-icon" style="background: var(--gradient-purple); font-size: 1rem;">œÉ¬≤</div>
                                <div>
                                    <strong>Heteroscedastic Noise</strong>
                                    <p style="font-size: 0.9rem;">Bernoulli variance from fidelity</p>
                                </div>
                            </li>
                            <li>
                                <div class="feature-icon" style="background: var(--gradient-green); font-size: 1rem;">‚Ü∫</div>
                                <div>
                                    <strong>Fixed-Target ZSInvert</strong>
                                    <p style="font-size: 0.9rem;">Consistent progress tracking</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 33: Key Parameters  -->
        <!-- ========================= -->
        <section class="slide" data-slide="33">
            <span class="section-badge fade-in">Summary</span>
            <h2 class="fade-in fade-in-delay-1">Key Parameters</h2>

            <div class="content-full fade-in fade-in-delay-2" style="justify-content: center;">
                <table style="font-size: 0.95rem;">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Parameter</th>
                            <th>Value</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>VAE</td>
                            <td><code>latent_dim</code></td>
                            <td style="color: var(--accent-purple);">32</td>
                            <td>24√ó compression</td>
                        </tr>
                        <tr>
                            <td>VAE</td>
                            <td><code>Œ≤</code></td>
                            <td style="color: var(--accent-purple);">0.01</td>
                            <td>KL regularization</td>
                        </tr>
                        <tr>
                            <td>Hyperband</td>
                            <td><code>Œ∑</code></td>
                            <td style="color: var(--accent-green);">2.0</td>
                            <td>Halving rate</td>
                        </tr>
                        <tr>
                            <td>GP</td>
                            <td><code>ARD dims</code></td>
                            <td style="color: var(--accent-cyan);">32</td>
                            <td>Per-dim lengthscales</td>
                        </tr>
                        <tr>
                            <td>TuRBO</td>
                            <td><code>L_init</code></td>
                            <td style="color: var(--accent-orange);">0.4</td>
                            <td>Initial trust region</td>
                        </tr>
                        <tr>
                            <td>Inference</td>
                            <td><code>num_restarts</code></td>
                            <td style="color: var(--accent-cyan);">64</td>
                            <td>L-BFGS-B multi-start</td>
                        </tr>
                        <tr>
                            <td>Candidate</td>
                            <td><code>cosine_threshold</code></td>
                            <td style="color: var(--accent-green);">0.93</td>
                            <td>Quality gate</td>
                        </tr>
                        <tr>
                            <td>ZSInvert</td>
                            <td><code>iterations</code></td>
                            <td style="color: var(--accent-purple);">25</td>
                            <td>Max refinement</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 34: Usage           -->
        <!-- ========================= -->
        <section class="slide" data-slide="34">
            <span class="section-badge fade-in">Usage</span>
            <h2 class="fade-in fade-in-delay-1">Running LIPO</h2>

            <div class="content-split">
                <div class="fade-in fade-in-delay-2">
                    <h3>Standard Run</h3>
                    <div class="code-block">
<span class="comment"># Full pipeline: APE ‚Üí VAE ‚Üí Hyperband ‚Üí InvBO</span>
uv run python -m lipo.run \
    --ape-instructions <span class="number">2000</span> \
    --iterations <span class="number">10</span>
                    </div>

                    <h3 style="margin-top: 1.5rem;">Skip HbBoPs (Use Pre-evaluated)</h3>
                    <div class="code-block">
<span class="comment"># Load existing HbBoPs results</span>
uv run python -m lipo.run \
    --skip-hbbops \
    --hyperband-evals-path data/evals.json
                    </div>
                </div>

                <div class="fade-in fade-in-delay-3">
                    <h3>Grid Loading</h3>
                    <div class="code-block">
<span class="comment"># Top-K from pre-computed grid</span>
uv run python -m lipo.run \
    --load-grid datasets/full_grid.jsonl \
    --top-k <span class="number">25</span> \
    --iterations <span class="number">10</span>
                    </div>

                    <h3 style="margin-top: 1.5rem;">Debug Mode</h3>
                    <div class="code-block">
<span class="comment"># Quick test run</span>
uv run python -m lipo.run \
    --debug \
    --iterations <span class="number">1</span> \
    --ape-instructions <span class="number">10</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================= -->
        <!-- SLIDE 35: Conclusion      -->
        <!-- ========================= -->
        <section class="slide slide-center" data-slide="35">
            <div class="fade-in">
                <h1 style="background: linear-gradient(135deg, var(--accent-cyan) 0%, var(--accent-purple) 50%, var(--accent-magenta) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 3.5rem;">
                    LIPO
                </h1>
                <p class="fade-in fade-in-delay-1" style="font-size: 1.5rem; color: var(--text-secondary); margin-top: 1rem;">
                    Latent Instruction Prompt Optimization
                </p>
            </div>

            <div class="fade-in fade-in-delay-2" style="margin-top: 3rem;">
                <div class="highlight-box highlight-purple" style="max-width: 700px; text-align: center;">
                    <p style="font-size: 1.2rem; color: var(--text-primary);">
                        Efficient prompt optimization through<br>
                        <strong style="color: var(--accent-cyan);">VAE compression</strong> +
                        <strong style="color: var(--accent-purple);">Bayesian optimization</strong> +
                        <strong style="color: var(--accent-green);">Text inversion</strong>
                    </p>
                </div>
            </div>

            <div class="fade-in fade-in-delay-3" style="margin-top: 3rem;">
                <span class="dim-badge">768D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-purple); color: var(--accent-purple);">32D</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-orange); color: var(--accent-orange);">Optimize</span>
                <span style="color: var(--text-muted); margin: 0 0.5rem;">‚Üí</span>
                <span class="dim-badge" style="border-color: var(--accent-green); color: var(--accent-green);">Text</span>
            </div>

            <p class="fade-in fade-in-delay-4" style="margin-top: 3rem; font-size: 1.1rem; color: var(--text-muted);">
                Thank you!
            </p>
        </section>

    </div>

    <!-- Progress bar -->
    <div class="progress-bar" id="progressBar"></div>

    <!-- Slide counter -->
    <div class="slide-counter">
        <span id="currentSlide">1</span> / <span id="totalSlides">35</span>
    </div>

    <!-- Navigation hint -->
    <div class="nav-hint">
        <kbd>‚Üê</kbd> <kbd>‚Üí</kbd> to navigate
    </div>

    <script>
        // Presentation logic
        const slides = document.querySelectorAll('.slide');
        const totalSlides = 35; // Will have 35 total
        let currentSlide = 0;

        document.getElementById('totalSlides').textContent = totalSlides;

        function updateSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                if (i === index) {
                    slide.classList.add('active');
                }
            });

            currentSlide = index;
            document.getElementById('currentSlide').textContent = index + 1;
            document.getElementById('progressBar').style.width =
                ((index + 1) / totalSlides * 100) + '%';
        }

        function nextSlide() {
            if (currentSlide < slides.length - 1) {
                updateSlide(currentSlide + 1);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                updateSlide(currentSlide - 1);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                prevSlide();
            }
        });

        // Touch support
        let touchStartX = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        });

        document.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > 50) {
                if (diff > 0) nextSlide();
                else prevSlide();
            }
        });

        // Initialize KaTeX
        document.addEventListener('DOMContentLoaded', function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });
        });
    </script>
</body>
</html>
